angular.module("mblowfish-core",["ngMaterial","ngAnimate","ngCookies","ngSanitize","ngRoute","seen-core","seen-tenant","seen-monitor","seen-cms","am-wb-core","am-wb-seen-core","lfNgMdFileInput","ngStorage","vcRecaptcha","ng-appcache","ngFileSaver","mdSteppers","angular-material-persian-datepicker"]).factory("Action",["MbAction",function(e){"use strict";return e}]).factory("ActionGroup",["MbActionGroup",function(e){"use strict";return e}]).factory("httpRequestInterceptor",["MbHttpRequestInterceptor",function(e){"use strict";return e}]).controller("MessagesCtrl",["$scope","$controller",function(e,t){"use strict";angular.extend(this,t("MbSeenUserMessagesCtrl",{$scope:e}))}]).controller("AmWbSeenCmsContentsCtrl",["$scope","$controller",function(e,t){"use strict";angular.extend(this,t("MbSeenCmsContentsCtrl",{$scope:e}))}]),angular.module("mblowfish-core").config(["$httpProvider",function(e){e.interceptors.push("httpRequestInterceptor")}]),angular.module("mblowfish-core").config(["$mdDateLocaleProvider",function(e){moment.locale("en");var t=moment.localeData();e.months=t._months,e.shortMonths=moment.monthsShort(),e.days=t._weekdays,e.shortDays=t._weekdaysMin,e.firstDayOfWeek=t._week.dow,e.parseDate=function(e){var t=moment(e,"L",!0);return t.isValid()?t.toDate():new Date(NaN)},e.formatDate=function(e){var t=moment(e);return t.isValid()?t.format("L"):""}}]),angular.module("mblowfish-core").config(["$routeProvider","$locationProvider",function(e,t){e.when("/initialization",{templateUrl:"views/mb-initial.html",controller:"MbInitialCtrl",controllerAs:"ctrl",protect:["$rootScope",function(e){return!e.app.user.owner}],sidenavs:[],toolbars:[]}).when("/preferences",{templateUrl:"views/mb-preferences.html",controller:"MbPreferencesCtrl",controllerAs:"ctrl",helpId:"preferences",protect:["$rootScope",function(e){return!e.app.user.owner}]}).when("/preferences/:preferenceId",{templateUrl:"views/mb-preference.html",controller:"MbPreferenceCtrl",helpId:["$routeParams",function(e){return"preferences-"+e.preferenceId}],protect:["$rootScope",function(e){return!e.app.user.owner}]}).when("/users/login",{templateUrl:"views/users/mb-login.html",controller:"MbAccountCtrl",controllerAs:"ctrl",sidenavs:[],toolbars:[]}).when("/users/account",{templateUrl:"views/users/mb-account.html",controller:"MbAccountCtrl",controllerAs:"ctrl",protect:!0,helpId:"mb-account"}).when("/users/profile",{templateUrl:"views/users/mb-profile.html",controller:"MbProfileCtrl",controllerAs:"ctrl",protect:!0,helpId:"mb-profile"}).when("/users/password",{templateUrl:"views/users/mb-password.html",controller:"MbAccountCtrl",controllerAs:"ctrl",protect:!0,helpId:"mb-profile"}).when("/users/reset-password",{templateUrl:"views/users/mb-forgot-password.html",controller:"MbAccountCtrl",controllerAs:"ctrl",sidenavs:[],toolbars:[]}).when("/users/reset-password/token",{templateUrl:"views/users/mb-recover-password.html",controller:"MbAccountCtrl",controllerAs:"ctrl",sidenavs:[],toolbars:[]}).when("/users/reset-password/token/:token",{templateUrl:"views/users/mb-recover-password.html",controller:"MbAccountCtrl",controllerAs:"ctrl",sidenavs:[],toolbars:[]}),t.html5Mode(!0)}]),angular.module("mblowfish-core").config(["$mdThemingProvider",function(e){e.definePalette("amdPrimaryPalette",{50:"#FFFFFF",100:"rgb(255, 198, 197)",200:"#E75753",300:"#E75753",400:"#E75753",500:"#E75753",600:"#E75753",700:"#E75753",800:"#E75753",900:"#E75753",A100:"#E75753",A200:"#E75753",A400:"#E75753",A700:"#E75753"}),e.theme("dark").primaryPalette("grey",{default:"900","hue-1":"700","hue-2":"600","hue-3":"500"}).accentPalette("grey",{default:"700"}).warnPalette("red").backgroundPalette("grey").dark(),e.alwaysWatchTheme(!0)}]),angular.module("mblowfish-core").controller("MbAbstractCtrl",["$scope","$dispatcher","MbEvent",function(e,t,n){"use strict";this._hids=[];this.addEventHandler=function(e,n){var i=t.on(e,n);this._hids.push(new function(e,t,n){this.type=e,this.id=t,this.callback=n}(e,i,n))},this.removeEventHandler=function(e,t){},this.fireEvent=function(e,i,r){var o=angular.isArray(r)?r:Array.prototype.slice.call(arguments,2);return t.dispatch(e,new n({source:this,type:e,key:i,values:o}))},this.fireCreated=function(e,t){var n=angular.isArray(t)?t:Array.prototype.slice.call(arguments,1);return this.fireEvent(e,"created",n)},this.fireRead=function(e,t){var n=angular.isArray(t)?t:Array.prototype.slice.call(arguments,1);return this.fireEvent(e,"read",n)},this.fireUpdated=function(e,t){var n=angular.isArray(t)?t:Array.prototype.slice.call(arguments,1);return this.fireEvent(e,"updated",n)},this.fireDeleted=function(e,t){var n=angular.isArray(t)?t:Array.prototype.slice.call(arguments,1);return this.fireEvent(e,"deleted",n)};var i=this;e.$on("$destroy",function(){for(var e=0;e<i._hids.length;e++){var n=i._hids[e];t.off(n.type,n.id)}i._hids=[]})}]),angular.module("mblowfish-core").controller("MbAccountCtrl",["$scope","$rootScope","$app","$translate","$window","$usr","$errorHandler",function(e,t,n,i,r,o,a){this.loginProcess=!1,this.loginState=null,this.logoutProcess=!1,this.logoutState=null,this.changingPassword=!1,this.changePassState=null,this.updatingAvatar=!1,this.loadingUser=!1,this.savingUser=!1,this.login=function(t,i){return!l.loginProcess&&(l.loginProcess=!0,n.login(t).then(function(){l.loginState="success",e.loginMessage=null},function(t){l.loginState="fail",e.loginMessage=a.handleError(t,i)}).finally(function(){l.loginProcess=!1}))},this.logout=function(){return!l.logoutProcess&&(l.logoutProcess=!0,n.logout().then(function(){l.logoutState="success"},function(){l.logoutState="fail"}).finally(function(){l.logoutProcess=!1}))},this.changePassword=function(t,r){if(!l.changingPassword){l.changingPassword=!0;var s={old:t.oldPass,new:t.newPass,password:t.newPass};o.putCredential(s).then(function(){n.logout(),l.changePassState="success",e.changePassMessage=null,toast(i.instant("Password is changed successfully. Login with new password."))},function(t){l.changePassState="fail",e.changePassMessage=a.handleError(t,r),alert(i.instant("Failed to change the password."))}).finally(function(){l.changingPassword=!1})}},this.updateAvatar=function(e){if(!l.updatingAvatar)return l.updatingAvatar=!0,l.user.uploadAvatar(e[0].lfFile).then(function(){r.location.reload(),toast(i.instant("Your avatar updated successfully."))},function(){alert(i.instant("Failed to update avatar"))}).finally(function(){l.updatingAvatar=!1})},this.back=function(){r.history.back()},this.loadUser=function(){if(!l.loadingUser)return l.loadingUser=!0,o.getAccount("current").then(function(e){l.user=e},function(e){l.error=e}).finally(function(){l.loadingUser=!1})},this.saveUser=function(t){if(!l.savingUser)return l.savingUser=!0,l.user.update().then(function(t){l.user=t,e.saveUserMessage=null,toast(i.instant("Your information updated successfully."))},function(n){e.saveUserMessage=a.handleError(n,t),alert(i.instant("Failed to update."))}).finally(function(){l.savingUser=!1})},e.apds=[{key:"first_name",title:"First name",type:"string"},{key:"last_name",title:"Last name",type:"string"},{key:"language",title:"language",type:"string"},{key:"timezone",title:"timezone",type:"string"}],e.$watch(function(){return t.app.user},function(t){e.appUser=t},!0);var l=this;e.login=function(e,t){l.login(e,t)},e.logout=function(){l.logout()},e.changePassword=function(){l.changePassword()},e.updateAvatar=function(){l.updateAvatar()},e.load=function(){l.loadUser()},e.reload=function(){l.loadUser()},e.saveUser=function(){l.saveUser()},e.back=function(){l.back()},e.cancel=function(){l.back()},this.loadUser()}]),angular.module("mblowfish-core").controller("MbHelpCtrl",["$scope","$rootScope","$route","$http","$translate","$help","$wbUtil",function(e,t,n,i,r,o,a){var l;function s(t){if(e.helpLoading)return e.helpLoading;var n=o.getHelpPath(t);return n&&n!==l&&(e.helpLoading=i.get(n).then(function(t){e.helpContent=a.clean(t.data),l=n}).finally(function(){e.helpLoading=!1})),e.helpLoading}t.showHelp=!1,e.closeHelp=function(){t.showHelp=!1},e.$watch("showHelp",function(e){if(e)return s()}),e.$watch(function(){return o.currentItem()},function(){t.showHelp&&s()})}]),angular.module("mblowfish-core").controller("MbInitialCtrl",["$scope","$rootScope","$preferences","$mdStepper","$window","$wbUtil","$routeParams",function(e,t,n,i,r,o,a){var l="setting-stepper";function s(){i(l).next()}function c(){var r="<wb-group ng-model='model' flex style='overflow: auto;' layout-fill></wb-group>",a={id:"welcome",title:"Welcome",template:r,controller:["$scope","$http","$translate",function(e,t,n){t.get("resources/welcome/"+n.use()+".json").then(function(t){e.model=o.clean(t.data)||{}})}],description:"Welcome. Please login to continue.",icon:"accessibility",priority:"first",required:!0},s={id:"congratulate",title:":)",description:"Congratulation. Your site is ready.",template:r,controller:["$scope","$http","$translate",function(e,n,i){n.get("resources/congratulate/"+i.use()+".json").then(function(t){e.model=o.clean(t.data)||{}}),t.app.config.is_initialized=!0}],icon:"favorite",priority:"last",required:!0};n.newPage({id:"initial-language",title:"Language",templateUrl:"views/preferences/mb-language.html",controller:"MbLanguageCtrl",description:"Select default language of web application.",icon:"language",priority:"first",required:!0}),n.newPage(a),n.newPage(s),n.pages().then(function(t){var n=[];t.items.forEach(function(e){e.required&&n.push(e)}),e.steps=n}),e.$watch(function(){var e=i(l);return e?e.currentStep:-1},function(t){t>=0&&e.steps&&e.steps.length&&(e.currentStep=e.steps[t])})}var u=e.$watch("app.state.status",function(e){switch(e){case"loading":case"fail":case"error":break;case"ready":u(),!a.force&&t.app.config.is_initialized?r.location=r.location.href.replace(/initialization$/gm,""):c()}});this.goToStep=function(e){i(l).goto(e)},this.nextStep=s,this.nextStep=s,this.prevStep=function(){i(l).back()}}]),angular.module("mblowfish-core").controller("MbLanguageCtrl",["$scope","$app","$rootScope","$http","$language",function(e,t,n,i,r){function o(t){e.myLanguage=t,n.app.config.languages=[],n.app.config.languages.push(e.myLanguage),r.use(e.myLanguage.key),n.app.config.local=n.app.config.local||{},angular.isObject(n.app.config.local)||(n.app.config.local={}),n.app.config.local.language=e.myLanguage.key,e.myLanguage.dir&&(n.app.config.local.dir=e.myLanguage.dir)}e.setLanguage=o,i.get("resources/languages.json").then(function(t){var n=t?t.data:{};e.languages=n.languages}).finally(function(){var t=r.use();if(e.languages)for(var n=0;n<e.languages.length;n++)if(e.languages[n].key===t)return void o(e.languages[n])})}]),angular.module("mblowfish-core").controller("MbLocalCtrl",["$scope","$language","$navigator",function(e,t,n){e.goToManage=function(){n.openPage("preferences/languages/manager")},e.languages=[],t.languages().then(function(t){return e.languages=t.items,e.languages})}]),angular.module("mblowfish-core").controller("AmdNavigatorDialogCtrl",["$scope","$mdDialog","config",function(e,t,n){e.config=n,e.hide=function(){t.hide()},e.cancel=function(){t.hide()},e.answer=function(e){t.hide(e)}}]),angular.module("mblowfish-core").controller("AmdNavigatorCtrl",["$scope","$navigator","$route",function(e,t,n){!function(){var i=[];angular.forEach(n.routes,function(e){e.navigate&&(e.type="link",e.link=e.originalPath,e.title=e.title||e.name||"no-name",e.priority=e.priority||100,i.push(e))}),angular.forEach(t.items(),function(e){i.push(e)}),e.menuItems={hiden:!1,sections:[]};var r=[];angular.forEach(i,function(n){n.groups?angular.forEach(n.groups,function(i){var o=t.group(i);o.id in r||(r[o.id]=angular.extend({type:"toggle",sections:[]},o),e.menuItems.sections.push(r[o.id])),r[o.id].sections.push(n)}):e.menuItems.sections.push(n)})}()}]),angular.module("mblowfish-core").controller("MbOptionsCtrl",["$scope","$options",function(e,t){t.pages().then(function(t){e.tabs=t.items})}]),angular.module("mblowfish-core").controller("MbPreferenceCtrl",["$scope","$routeParams","$navigator","$preferences",function(e,t,n,i){i.page(t.preferenceId).then(function(t){e.preference=t},function(){n.openPage("preferences")}),e.preferenceId=t.preferenceId}]),angular.module("mblowfish-core").controller("MbPreferencesCtrl",["$scope","$preferences",function(e,t){t.pages().then(function(t){e.preferenceTiles=[],e.pages=[];for(var n=0;n<t.items.length;n++){var i=t.items[n];i.hidden||(e.preferenceTiles.push({colspan:1,rowspan:1,page:i}),e.pages.push(i))}}),e.openPreference=function(e){t.openPage(e)}}]),angular.module("mblowfish-core").controller("MbProfileCtrl",["$scope","$rootScope","$translate","$window","UserProfile",function(e,t,n,i,r){this.user=null,this.profile=null,this.loadingProfile=!1,this.savingProfile=!1,this.avatarState="normal",this.loadUser=function(){var e=(t.app||{}).user||{};this.user=e.current,this.user?this.loadProfile():alert(n.instant("Fail to load user."))},this.loadProfile=function(){if(!this.loadinProfile){this.loadingProfile=!0;var e=this;return this.user.getProfiles().then(function(t){return e.profile=angular.isDefined(t.items[0])?t.items[0]:new r,e.profile},function(){alert(n.instant("Fial to load profile."))}).finally(function(){e.loadingProfile=!1})}},this.save=function(){if(!this.savingProfile){this.savingProfile=!0;var e=this;return(angular.isDefined(this.profile.id)?this.profile.update():this.user.putProfile(this.profile)).then(function(){toast(n.instant("Save is successfull."))},function(){alert(n.instant("Fail to save item."))}).finally(function(){e.savingProfile=!1})}},this.back=function(){i.history.back()},this.deleteAvatar=function(){var e=this;confirm("Delete the avatar?").then(function(){return e.avatarState="working",e.user.deleteAvatar()}).finally(function(){e.avatarState="normal"})},this.uploadAvatar=function(e){!angular.isArray(e)||e.length;var t;t=e[0].lfFile,this.avatarLoading=!0;var n=this;this.user.uploadAvatar(t).then(function(){}).finally(function(){n.avatarLoading=!1,n.avatarState="normal"})},this.editAvatar=function(){this.avatarState="edit"},this.cancelEditAvatar=function(){this.avatarState="normal"};var o=this;e.load=function(){o.loadUser()},e.reload=function(){o.loadUser()},e.save=function(){o.save()},e.back=function(){o.back()},e.cancel=function(){o.back()},this.loadUser()}]),angular.module("mblowfish-core").controller("MbSeenAbstractBinaryItemCtrl",["$scope","$controller","$q","$navigator","$window","QueryParameter","Action",function(e,t,n,i,r,o,a){"use strict";angular.extend(this,t("MbSeenAbstractItemCtrl",{$scope:e}));this.deleteModelBinary=function(e){return n.reject("This method must be override in clild class")},this.uploadModelBinary=function(e){return n.reject("This method must be override in clild class")},this.getModelBinaryUrl=function(e){return n.reject("This method must be override in clild class")},this.itemUrl,this.setItemUrl=function(e){this.itemUrl=e},this.getItemUrl=function(){return this.itemUrl},this.deleteItemBinary=function(){$event&&($event.preventDefault(),$event.stopPropagation());var e=this,t=this.getItem();function n(){return e.busy=!0,e.getModelBinaryUrl(t).then(function(){e.fireDeleted(e.getModelBinaryUrl(t),t)},function(){}).finally(function(){e.busy=!1})}if(!this.isConfirmationRequired())return n();r.confirm("Delete binary content?").then(function(){return n()})},this.supperInit=this.init,this.init=function(e){angular.isDefined(configs)&&(this.setItemUrl(e.url),this.supperInit(e))}}]),angular.module("mblowfish-core").controller("MbSeenAbstractCollectionCtrl",["$scope","$controller","$q","$navigator","$window","QueryParameter","Action",function(e,t,n,i,r,o,a){"use strict";function l(e,t,n){for(var i=e,r=0;r<t.length;r++)i=_.remove(i,function(e){return e[n]!==t[r][n]});return i}angular.extend(this,t("MbSeenGeneralAbstractCollectionCtrl",{$scope:e}));this.state="ideal";this.actions=[],this.state="init",this.lastResponse=null,this.queryParameter=new o,this.queryParameter.setOrder("id","d"),this.items=[],this.pushViewItems=function(e){if(angular.isDefined(e))for(var t=l(e,this.items,"id"),n=0;n<t.length;n++)this.items.push(t[n])},this.addViewItems=this.pushViewItems,this.removeViewItems=function(e){this.items=l(this.items,e,"id")},this.updateViewItems=function(e){},this.getViewItems=function(){return this.items},this.clearViewItems=function(){this.items=[]},this.addItem=function(){var e=this;i.openDialog({templateUrl:this._addDialog,config:{model:{}}}).then(function(t){return e.addModel(t)}).then(function(t){e.fireCreated(e.eventType,t)},function(){r.alert("Fail to add new item")})},this.deleteItem=function(e,t){t&&(t.preventDefault(),t.stopPropagation());var n=this,i=_.clone(e);function o(){return n.deleteModel(e).then(function(){n.fireDeleted(n.eventType,i)},function(){})}if(!this.deleteConfirm)return o();r.confirm("Delete item?").then(function(){return o()})},this.reload=function(){var e=this;function t(){return delete e.lastResponse,e.clearViewItems(),e.queryParameter.setPage(1),e.loadNextPage()}return this.isBusy()?this.getLastQeury().then(t):t()},this.loadNextPage=function(){if(!angular.isFunction(this.getModels))throw"The controller does not implement getModels function";if("init"===this.state)throw"this.init() function is not called in the controller";if("ideal"!==this.state){if(this.lastQuery)return this.lastQuery;throw"Models controller is not in ideal state"}if(this.lastResponse){if(!this.lastResponse.hasMore())return n.resolve();this.queryParameter.setPage(this.lastResponse.getNextPageIndex())}this.state="busy";var e=this;return this.lastQuery=this.getModels(this.queryParameter).then(function(t){e.lastResponse=t,e.addViewItems(t.items),e.error=null},function(t){e.error=t}).finally(function(){e.state="ideal",delete e.lastQuery}),this.lastQuery},this.seen_abstract_collection_superInit=this.init,this.init=function(e){angular.isFunction(this.seen_abstract_collection_superInit)&&this.seen_abstract_collection_superInit(e);var t=this;if(this.state="ideal",angular.isDefined(e)){if(angular.isArray(e.actions)&&this.addActions(e.actions),e.addAction&&angular.isFunction(this.addItem)){var n=e.addAction,i={title:n.title||"New item",icon:n.icocn||"add",action:n.action};!angular.isFunction(n.action)&&n.dialog&&(this._addDialog=n.dialog,i.action=function(){t.addItem()}),angular.isFunction(i.action)&&this.addAction(i)}this._setEventType(e.eventType),this.deleteConfirm=!angular.isDefined(e.deleteConfirm)||e.deleteConfirm}},this.getLastQeury=function(){return this.lastQuery},this.setDataQuery=function(e){this.queryParameter.put("graphql","{page_number, current_page, items"+e+"}")},this.getActions=function(){return this.actions},this.addAction=function(e){return angular.isDefined(this.actions)||(this.actions=[]),e instanceof a||(e=new a(e)),this.actions.push(e),this},this.addActions=function(e){for(var t=0;t<e.length;t++)this.addAction(e[t])},this.getQueryParameter=function(){return this.queryParameter},this.isBusy=function(){return"busy"===this.state},this.isIdeal=function(){return"ideal"===this.state},this.eventHandlerCallBack=function(){if(this._eventHandlerCallBack)return this._eventHandlerCallBack;var e=this;return this._eventHandlerCallBack=function(t){switch(t.key){case"created":e.pushViewItems(t.values);break;case"updated":e.updateViewItems(t.values);break;case"removed":e.removeViewItems(t.values)}},this._eventHandlerCallBack},this._setEventType=function(e){if(this.eventType!==e){var t=this.eventHandlerCallBack();this.eventType&&this.removeEventHandler(t),this.eventType=e,this.addEventHandler(this.eventType,t)}}}]),angular.module("mblowfish-core").controller("MbSeenAbstractItemCtrl",["$scope","$controller","$q","$navigator","$window","QueryParameter","Action",function(e,t,n,i,r,o,a){"use strict";angular.extend(this,t("MbSeenGeneralAbstractCollectionCtrl",{$scope:e}));this.actions=[],this.busy=!1,this.dirty=!1,this.deleteModel=function(e){return n.reject("This method must be override in clild class")},this.getModelSchema=function(){return n.reject("This method must be override in clild class")},this.getModel=function(e){return n.reject("This method must be override in clild class")},this.updateModel=function(e){return n.reject("This method must be override in clild class")},this.item,this.setItem=function(e){this.item=e},this.getItem=function(){return this.item},this.getItemProperty=function(e,t){},this.setItemProperty=function(e,t){},this.isBusy=function(){return this.busy},this.dirty=function(){return this.dirty},this.isConfirmationRequired=function(){return this.confirmationRequired},this.setConfirmationRequired=function(e){this.confirmationRequired=e},this.deleteItem=function(e,t){t&&(t.preventDefault(),t.stopPropagation());var n=this,i=_.clone(e);function o(){return n.busy=!0,n.deleteModel(e).then(function(){n.fireDeleted(n.eventType,i)},function(){}).finally(function(){n.busy=!1})}if(!this.isConfirmationRequired())return o();r.confirm("Delete the item?").then(function(){return o()})},this.reload=function(){var e=this;function t(){return e.setItem(null),e.loadItem(this.getItemId())}if(this.isBusy())return this.getLastPromis().then(t);var n=t();return this.setLastPromis(n),n},this.setDataQuery=function(e){this.queryParameter.put("graphql","{page_number, current_page, items"+e+"}")},this.eventHandlerCallBack=function(){if(this._eventHandlerCallBack)return this._eventHandlerCallBack;var e=this;return this._eventHandlerCallBack=function(t){switch(t.key){case"updated":e.updateViewItems(t.values);break;case"removed":e.removeViewItems(t.values)}},this._eventHandlerCallBack},this.setEventType=function(e){if(this.eventType!==e){var t=this.eventHandlerCallBack();this.eventType&&this.removeEventHandler(t),this.eventType=e,this.addEventHandler(this.eventType,t)}},this.seen_abstract_item_supperInit=this.init,this.init=function(e){this.seen_abstract_item_supperInit&&this.seen_abstract_item_supperInit(e);angular.isDefined(e)&&(this.setEventType(e.eventType),this.setConfirmationRequired(!angular.isDefined(e.confirmation)||e.confirmation),config.dataQuery&&this.setDataQuery(config.dataQuery),config.modelId,config.model)}}]),angular.module("mblowfish-core").controller("MbSeenCmsContentsCtrl",["$scope","$cms","$q","$controller","uuid4",function(e,t,n,i,r){angular.extend(this,i("MbSeenAbstractCollectionCtrl",{$scope:e})),this.getModelSchema=function(){return t.contentSchema()},this.getModels=function(e){return t.getContents(e)},this.getModel=function(e){return t.getContent(e)},this.deleteModel=function(e){return t.deleteContent(e.id)},this.uploadFile=function(e,i){return t.putContent(e).then(function(e){return i?e.uploadValue(i).then(function(){return e}):n.resolve(e)})},this.init({eventType:"/cms/contents"})}]),angular.module("mblowfish-core").controller("MbSeenGeneralAbstractCollectionCtrl",["$scope","$controller","$q",function(e,t,n){"use strict";angular.extend(this,t("MbAbstractCtrl",{$scope:e})),this.getSchema=function(){if(angular.isDefined(this.getModelSchema()))return this.getModelSchema().then(function(e){return e})},this.getProperties=function(){angular.isDefined(this.properties)&&n.resolve(this.properties);var e=this;return this.getSchema().then(function(t){e.properties=t.children})},this.init=function(){this.getProperties()}}]),angular.module("mblowfish-core").controller("MbSeenUserAccountCtrl",["$scope","$usr","$controller",function(e,t,n){angular.extend(this,n("MbSeenAbstractItemCtrl",{$scope:e})),this.getModelSchema=function(){return t.profileSchema()},this.getModel=function(e){return t.getProfile(e)},this.deleteModel=function(e){return t.deleteProfile(e.id)},this.deleteModelBinary=function(e){return $q.reject(IMPLEMENT_BY_CHILDREN_ERROR)},this.uploadModelBinary=function(e){return $q.reject(IMPLEMENT_BY_CHILDREN_ERROR)},this.getModelBinaryUrl=function(e){return $q.reject(IMPLEMENT_BY_CHILDREN_ERROR)}}]),angular.module("mblowfish-core").controller("MbSeenUserAccountsCtrl",["$scope","$usr","$controller",function(e,t,n){angular.extend(this,n("MbSeenAbstractCollectionCtrl",{$scope:e})),this.getModelSchema=function(){return t.accountSchema()},this.getModels=function(e){return t.getAccounts(e)},this.getModel=function(e){return t.getAccount(e)},this.addModel=function(e){return t.putAccount(e)},this.deleteModel=function(e){return t.deleteAccount(e.id)},this.init({eventType:"/user/account"})}]),angular.module("mblowfish-core").controller("MbSeenUserGroupsCtrl",["$scope","$usr","$controller",function(e,t,n){angular.extend(this,n("MbSeenAbstractCollectionCtrl",{$scope:e})),this.getModelSchema=function(){return t.groupSchema()},this.getModels=function(e){return t.getGroups(e)},this.getModel=function(e){return t.getGroup(e)},this.addModel=function(e){return t.putGroup(e)},this.deleteModel=function(e){return t.deleteGroup(e.id)},this.init({eventType:"/user/groups"})}]),angular.module("mblowfish-core").controller("MbSeenUserMessagesCtrl",["$scope","$usr","$controller",function(e,t,n){angular.extend(this,n("MbSeenAbstractCollectionCtrl",{$scope:e})),this.getModelSchema=function(){return t.messageSchema()},this.getModels=function(e){return t.getMessages(e)},this.getModel=function(e){return t.getMessage(e)},this.deleteModel=function(e){return e.delete()},this.init({eventType:"/user/messages",deleteConfirm:!1})}]),angular.module("mblowfish-core").controller("MbSeenUserProfilesCtrl",["$scope","$usr","$controller",function(e,t,n){angular.extend(this,n("MbSeenAbstractCollectionCtrl",{$scope:e})),this.getModelSchema=function(){return t.profileSchema()},this.getModels=function(e){return t.getProfiles(e)},this.getModel=function(e){return t.getProfile(e)},this.addModel=function(e){return t.putProfile(e)},this.deleteModel=function(e){return t.deleteProfile(e.id)},this.init()}]),angular.module("mblowfish-core").controller("MbSeenUserRolesCtrl",["$scope","$usr","$q","$controller",function(e,t,n,i){angular.extend(this,i("MbSeenAbstractCollectionCtrl",{$scope:e})),this.getModelSchema=function(){return t.roleSchema()},this.getModels=function(e){return t.getRoles(e)},this.getModel=function(e){return t.getRole(e)},this.deleteModel=function(e){return t.deleteRole(e.id)},this.init()}]),angular.module("mblowfish-core").controller("MbThemesCtrl",["$scope","$mdTheming",function(e,t){e.themes=[],angular.forEach(t.THEMES,function(t,n){e.themes.push({id:n,label:t.name})})}]),angular.module("mblowfish-core").controller("MbToolbarDashboardCtrl",["$scope","$actions","$mdSidenav","$monitor",function(e,t,n,i){e.toolbarMenu=t.group("mb.toolbar.menu"),e.toggleNavigationSidenav=function(){n("navigator").toggle()},e.toggleMessageSidenav=function(){n("messages").toggle()},i.getMetric("message.count").then(function(t){e.messageCount=t.value})}]),angular.module("mblowfish-core").directive("compareTo",function(){return{require:"ngModel",scope:{otherModelValue:"=compareTo"},link:function(e,t,n,i){i.$validators.compareTo=function(t){return t===e.otherModelValue},e.$watch("otherModelValue",function(){i.$validate()})}}}),angular.module("mblowfish-core").directive("mbBadge",["$mdTheming","$rootScope",function(e,t){return{restrict:"E",replace:!0,transclude:!0,link:function(n,i,r){function o(n,r){r&&i.css(n,function(n){var i=(n||"").split("-");i.length<2&&i.push("500");var r=i[1]||"800",o=i[0]||"primary",a=e.THEMES[t.app.setting.theme||t.app.config.theme||"default"];void 0===a&&(a=e.THEMES.default);var l=a.colors[o]?a.colors[o].name:o;return"rgb("+(e.PALETTES[l][r]?e.PALETTES[l][r].value:e.PALETTES[l][500].value).join(",")+")"}(r))}e(i),n.$watch(function(){return r.mbBadgeColor},function(e){o("color",e)}),n.$watch(function(){return r.mbBadgeFill},function(e){o("background-color",e)})},template:function(){return'<div class="mb-badge" ng-transclude></div>'}}}]),angular.module("mblowfish-core").directive("mbBadge",["$mdTheming","$mdColors","$timeout","$window","$compile","$rootScope",function(e,t,n,i,r,o){return{priority:100,restrict:"A",link:function(t,n,i){e(n);var a=n.parent(),l=angular.element("<div></div>"),s=r(l)(t),c=parseInt(i.mdBadgeOffset);function u(t,n){n&&s.css(t,function(t){var n=(t||"").split("-");n.length<2&&n.push("500");var i=n[1]||"800",r=n[0]||"primary",a=e.THEMES[o.app.setting.theme||o.app.config.theme||"default"];void 0===a&&(a=e.THEMES.default);var l=a.colors[r]?a.colors[r].name:r;return"rgb("+(e.PALETTES[l][i]?e.PALETTES[l][i].value:e.PALETTES[l][500].value).join(",")+")"}(n))}isNaN(c)&&(c=10),s.addClass("mb-badge"),s.css("position","absolute"),a.append(s),t.$watch(function(){return i.mbBadgeColor},function(e){u("color",e)}),t.$watch(function(){return i.mbBadgeFill},function(e){u("background-color",e)}),t.$watch(function(){return i.mbBadge},function(e){s.text(e),s.css("display",e?"initial":"none")}),t.$watch(function(){return{top:n.prop("offsetTop"),left:n.prop("offsetLeft"),width:n.prop("offsetWidth"),height:n.prop("offsetHeight")}},function(e){!function(e){var t=n.prop("offsetTop");s.css({display:i.mbBadge&&t?"initial":"none",left:e.left+e.width-20+c+"px",top:e.top+e.height-20+c+"px"})}(e)},!0)}}}]),angular.module("mblowfish-core").directive("mbCaptcha",function(){return{restrict:"E",require:["?^^form"],templateUrl:"views/directives/mb-captcha.html",scope:{response:"=?ngModel"},link:function(e,t,n,i){var r=i[0];r&&angular.isDefined(n.required)&&e.$watch("required",function(){r&&r.$setValidity("captcha",!1===e.required?null:Boolean(e.response))}),e._response=null,e.$watch("_response",function(){e.response=e._response}),e.$watch("response",function(){e._response=e.response})}}}),angular.module("mblowfish-core").directive("mbContextMenu",function(){return{restrict:"A",require:"mdMenu",scope:!0,link:function(e,t,n,i){t.bind("contextmenu",function(t){e.$apply(function(){i.open(t)})})}}}),angular.module("mblowfish-core").directive("mbDatepicker",["$mdUtil","$rootScope",function(e,t){return{replace:!1,template:function(){return"Gregorian"===(t.app||{}).calendar?'<md-datepicker ng-model="date" md-hide-icons="calendar" md-placeholder="{{placeholder || \'Enter date\'}}"></md-datepicker>':'<md-persian-datepicker ng-model="date" md-hide-icons="calendar" md-placeholder="{{placeholder || \'Enter date\'}}"></md-persian-datepicker>'},restrict:"E",scope:{minDate:"=mbMinDate",maxDate:"=mbMaxDate",placeholder:"@mbPlaceholder",hideIcons:"@?mbHideIcons"},require:["ngModel"],priority:210,link:function(n,i,r,o){n.app=t.app||{};var a=o[0]||e.fakeNgModel();a.$render=function(){if(a.$modelValue){var e=moment.utc(a.$modelValue).local();e.isValid()&&(n.date=e)}else n.date=null},n.$watch("date",function(){if(n.date){var e=moment(n.date).utc().format("YYYY-MM-DD HH:mm:ss");a.$setViewValue(e)}else a.$setViewValue(null)})}}}]),angular.module("mblowfish-core").directive("mbDynamicForm",function(){return{restrict:"E",require:["ngModel"],templateUrl:"views/directives/mb-dynamic-form.html",scope:{mbParameters:"="},link:function(e,t,n,i){var r=i[0];e.values={},r.$render=function(){e.values=r.$viewValue||{}},e.modelChanged=function(t,n){e.values[t]=n,r.$setViewValue(e.values)}}}}),angular.module("mblowfish-core").directive("mbDynamicTabs",["$wbUtil","$q","$rootScope","$compile","$controller",function(e,t,n,i,r){var o="mb-dynamic-tabs-select-resource-children";return{restrict:"E",replace:!0,scope:{mbTabs:"="},templateUrl:"views/directives/mb-dynamic-tabs.html",link:function(a,l){a.$watch("pageIndex",function(s){s>=0&&function(s){var c=[],u=[],d=a.mbTabs||[];if(!(s>d.length||s<0||0==d.length)){var m=d[s],p=l.find("#"+o);p.empty();var g=e.getTemplateFor(m);angular.isDefined(g)&&c.push(g.then(function(e){e=e;var t=angular.element(e),o=n.$new(!1,a);o.page=m,o.value=a.value,angular.isDefined(m.controller)&&r(m.controller,{$scope:o,$element:t}),i(t)(o),u.push(t)})),t.all(c).then(function(){angular.forEach(u,function(e){p.append(e)})})}}(s)})}}}]),angular.module("mblowfish-core").directive("mbErrorMessages",["$compile",function(e){return{restrict:"A",scope:{mbErrorMessages:"="},link:function(t,n){var i=null;t.errorMessages=function(e){if(e){var t={};return t[e.status]=e.statusText,t[e.data.code]=e.data.message,t}},t.$watch(function(){return t.mbErrorMessages},function(r){if(r){var o=angular.element('<div ng-messages="errorMessages(mbErrorMessages)" role="alert" multiple>\t<div ng-messages-include="views/mb-error-messages.html"></div></div>'),a=e(o)(t);i=n.replaceWith(a)}else i&&(n.replaceWith(i),i=null)})}}}]),angular.module("mblowfish-core").directive("mbInfinateScroll",["$parse","$q","$timeout",function(e,t,n){return{restrict:"A",link:function(i,r,o){var a=r[0];function l(){var r=e(o.mbInfinateScroll)(i);return t.when(r).then(function(e){if(e)return n(function(){if(a.scrollHeight<=a.offsetHeight)return l()},100)})}r.addClass("mb-infinate-scroll"),r.on("scroll",function(){a.scrollTop+a.offsetHeight+5>=a.scrollHeight&&l()}),l()}}}]),angular.module("mblowfish-core").directive("mbInline",["$q","$parse","$resource",function(e,t,n){return{restrict:"E",transclude:!0,replace:!0,require:["mbInline","^ngModel"],scope:!0,controller:["$scope",function(e){this.edit=function(){this.editMode=!0},this.setEditMode=function(e){this.editMode=e},this.getEditMode=function(){return this.editMode},this.save=function(){this.saveModel(this.model),this.setEditMode(!1)},this.cancel=function(){this.setEditMode(!1)},this.updateImage=function(){if(e.mbInlineEnable)return n.get("image",{style:{icon:"image",title:e.mbInlineLabel||"Select image",description:e.mbInlineDescription||"Select a file from resources or cancel"},data:this.model}).then(function(e){ctrl.model=e,ctrl.save()})}}],controllerAs:"ctrlInline",templateUrl:"views/directives/mb-inline.html",link:function(n,i,r,o){var a=o[1],l=o[0];n.myDataModel={},n.errorObject={},n.mbInlineType=r.mbInlineType,n.mbInlineLabel=r.mbInlineLabel,n.mbInlineDescription=r.mbInlineDescription,n.$watch(r.mbInlineEnable,function(e){n.mbInlineEnable=e}),n.$watch(r.mbInlineSaveButton,function(e){n.mbInlineSaveButton=e}),n.$watch(r.mbInlineCancelButton,function(e){n.mbInlineCancelButton=e}),a.$render=function(){l.model=a.$viewValue},l.saveModel=function(i){if(a.$setViewValue(i),r.mbInlineOnSave){n.$data=i;var o=t(r.mbInlineOnSave)(n);e.when(o).then(function(){n.errorObject={error:!1,errorMessage:null}},function(e){n.errorObject={error:!0,errorMessage:val}})}}}}}]),angular.module("mblowfish-core").directive("mbNavigationBar",["$actions","$navigator",function(e,t){return{restrict:"E",replace:!1,templateUrl:"views/directives/mb-navigation-bar.html",link:function(n){n.isVisible=function(e){return!!angular.isUndefined(e.visible)||(angular.isFunction(e.visible)?e.visible():e.visible)},n.goToHome=function(){t.openPage("")},n.pathMenu=e.group("navigationPathMenu")}}}]),angular.module("mblowfish-core").directive("mbPaginationBar",["$window","$timeout","$mdMenu","$parse",function(e,t,n,i){return{restrict:"E",templateUrl:"views/directives/mb-pagination-bar.html",scope:{mbModel:"=",mbReload:"@?",mbExport:"=",mbSortKeys:"=",mbProperties:"=?",mbSortKeysTitles:"=?",mbMoreActions:"=",mbTitle:"@?",mbIcon:"@?",mbEnableSearch:"=?"},link:function(n,r,o){var a={sortDesc:!0,sortBy:void 0===n.mbSortKeys?"id":n.mbSortKeys[0],searchTerm:null};function l(){angular.isDefined(o.mbReload)&&i(o.mbReload)(n.$parent)}function s(e,t){n.filters[t]={key:e.key,value:e.value}}n.showBoxOne=!1,n.focusToElement=function(n){t(function(){e.document.getElementById(n).focus()},50)},n.searchQuery=function(){n.mbModel.setQuery(n.query.searchTerm),l()},n.setSortOrder=function(){n.mbModel.clearSorters();var e=n.query.sortBy,t=n.query.sortDesc?"d":"a";n.mbModel.addSorter(e,t),l()},n.addFilter=function(){n.filters||(n.filters=[]),n.filters.push({key:"",value:""})},n.putFilter=s,n.applyFilter=function(){n.reload=!1,n.mbModel.clearFilters(),n.filters&&n.filters.length>0&&n.filters.forEach(function(e){""!==e.key&&e.value&&""!==e.value&&(n.mbModel.addFilter(e.key,e.value),n.reload=!0)}),n.reload&&l()},n.removeFilter=function(e,t){Object.keys(n.mbModel.filterMap).forEach(function(i){i===e.key&&n.mbModel.removeFilter(n.filters[t].key)}),n.filters.splice(t,1),0===n.filters.length&&l()},n.setFilterValue=function(e,t){n.filterValue=e,s(t)},n.__reload=l,n.query=a,angular.isFunction(n.mbExport)&&(n.exportData=function(){angular.isFunction(n.mbExport)&&n.mbExport(n.mbModel)}),void 0===n.mbEnableSearch&&(n.mbEnableSearch=!0),n.$watch("mbProperties",function(e){angular.isArray(e)&&(n.filterKeys=[],n.mbProperties.forEach(function(e){n.filterKeys.push(e.name)}))})}}}]),angular.module("mblowfish-core").directive("mbPanelSidenavAnchor",["$route","$sidenav","$rootScope","$mdSidenav","$q","$wbUtil","$controller","$compile",function(e,t,n,i,r,o,a,l){var s=angular.element("<div></div>");return{restrict:"A",priority:601,link:function(c,u){var d=[];function m(e){for(var t=0;t<d.length;t++)if(d[t].page.id===e.id)return r.when(d[t]);return function(e,t,r,c){var u=e.$new(!1,e);return u=Object.assign(u,{app:n.app,_page:t,_visible:function(){if(angular.isFunction(this._page.visible)){var e=this._page.visible(this);return e?i(this._page.id).open():i(this._page.id).close(),e}return!0}}),o.getTemplateFor(t).then(function(e){var n=angular.element(r+e+c);s.append(n);var i=l(n);if(angular.isDefined(t.controller)){var o={$scope:u,$element:n},d=a(t.controller,o);t.controllerAs&&(u[t.controllerAs]=d),n.data("$ngControllerController",d)}return{element:i(u),page:t}})}(c,e,"<md-sidenav md-theme=\"{{app.setting.theme || app.config.theme || 'default'}}\" md-theme-watch md-component-id=\"{{_page.id}}\" md-is-locked-open=\"_visible() && (_page.locked && $mdMedia('gt-sm'))\" md-whiteframe=\"2\" ng-class=\"{'md-sidenav-right': app.dir=='rtl',  'md-sidenav-left': app.dir!='rtl', 'mb-sidenav-ontop': !_page.locked}\" layout=\"column\">","</md-sidenav>").then(function(e){d.push(e)})}c.$watch(function(){return e.current},function(){if(angular.isDefined(e.current)){var n=e.current.sidenavs||t.defaultSidenavs();(n=n.slice(0)).push("settings"),n.push("help"),n.push("messages");var i=[],o=[];angular.forEach(n,function(e){o.push(t.sidenav(e).then(function(e){i.push(e)}))}),r.all(o).then(function(){!function(e){d=function(e,t){for(var n=[],i=0;i<t.length;i++){for(var r=!1,o=0;o<e.length;o++)if(e[o].id===t[i].page.id){r=!0;break}r?(t[i].element.detach(),t[i].cached=!0,n.push(t[i])):t[i].element.remove()}return n}(e,d);for(var t=[],n=0;n<e.length;n++)t.push(m(e[n]));r.all(t).then(function(){var e=u;d.sort(function(e,t){return(e.page.priority||10)>(t.page.priority||10)});for(var t=0;t<d.length;t++){var n=d[t];n.chached||("start"===n.page.position?e.prepend(n.element):e.append(n.element))}})}(i)})}})}}}]),angular.module("mblowfish-core").directive("mbPanelToolbarAnchor",["$route","$toolbar","$rootScope","$q","$wbUtil","$controller","$compile",function(e,t,n,i,r,o,a){return{restrict:"A",link:function(l,s){var c=[];function u(e){for(var t=0;t<c.length;t++)if(c[t].page.id===e.id)return i.when(c[t]);var s=e.raw?"":'<md-toolbar id="{{_page.id}}" ng-show="_visible()" md-theme="{{app.setting.theme || app.config.theme || \'default\'}}" md-theme-watch layout="column" layout-gt-xs="row" layout-align="space-between stretch">',u=e.raw?"":"</md-toolbar>";return function(e,t,i,l){var s=e.$new(!1,e);return s=Object.assign(s,{app:n.app,_page:t,_visible:function(){return!angular.isFunction(this._page.visible)||this._page.visible(this)}}),r.getTemplateFor(t).then(function(e){var n=angular.element(i+e+l),r=a(n);if(angular.isDefined(t.controller)){var c={$scope:s,$element:n},u=o(t.controller,c);t.controllerAs&&(s[t.controllerAs]=u),n.data("$ngControllerController",u)}return{element:r(s),page:t}})}(l,e,s,u).then(function(e){c.push(e)})}l.$watch(function(){return e.current},function(){if(e.current){var n=e.current.toolbars||t.defaultToolbars();if(angular.isArray(n)){var r=[],o=[];angular.forEach(n,function(e){o.push(t.toolbar(e).then(function(e){r.push(e)}))}),i.all(o).then(function(){!function(e){c=function(e,t){for(var n=[],i=0;i<t.length;i++){for(var r=!1,o=0;o<e.length;o++)if(e[o].id===t[i].page.id){r=!0;break}r?(t[i].element.detach(),t[i].cached=!0,n.push(t[i])):t[i].element.remove()}return n}(e,c);for(var t=[],n=0;n<e.length;n++)t.push(u(e[n]));i.all(t).then(function(){var e=s;c.sort(function(e,t){return(e.page.priority||10)>(t.page.priority||10)});for(var t=0;t<c.length;t++){var n=c[t];n.chached||e.prepend(n.element)}})}(r)})}}})}}}]),angular.module("mblowfish-core").directive("mbPanel",["$route","$rootScope","$actions","$injector",function(e,t,n,i){function r(e){return!e.protect||(angular.isFunction(e.protect)?!i.invoke(e.protect,e):e.protect)}return{restrict:"E",replace:!0,templateUrl:"views/directives/mb-panel.html",link:function(o){var a=new machina.Fsm({initialize:function(){o.status=this.initialState},namespace:"mb-panel-controller",initialState:"loading",states:{ready:{routeChange:function(e){!e.protect||r(e)||this.transition("accessDenied")},appStateChange:function(e){e.startsWith("ready")||this.transition("loading")},userStateChange:function(e){e&&(this.getRoute().protect&&e?this.transition("login"):this.transition("readyAnonymous"))}},accessDenied:{routeChange:function(e){e.protect&&!r(e)||this.transition("ready")},appStateChange:function(e){e.startsWith("ready")||this.transition("loading")},userStateChange:function(e){e&&this.transition("login")}},readyAnonymous:{routeChange:function(e){e.protect&&this.transition("login")},appStateChange:function(e){e.startsWith("ready")||this.transition("loading")},userStateChange:function(){this.transition("ready")}},loading:{appStateChange:function(e){if(e.startsWith("ready")){var n=this.getRoute();t.app.user.anonymous?n.protect?this.transition("login"):this.transition("readyAnonymous"):!n.protect||r(n)?this.transition("ready"):this.transition("accessDenied")}}},login:{routeChange:function(e){e.protect||this.transition("readyAnonymous")},appStateChange:function(e){e.startsWith("ready")||this.transition("loading")},userStateChange:function(){r(this.getRoute())?this.transition("ready"):this.transition("accessDenied")}}},routeChange:function(e){this.currentRoute=e,e&&this.handle("routeChange",e)},appStateChange:function(e){e&&this.handle("appStateChange",e)},userStateChange:function(e){this.userState=e,this.handle("userStateChange",e)},getRoute:function(){return this.currentRoute||e.current},getState:function(){return this.appState||t.app.state.status}});a.on("transition",function(){a.state.startsWith("ready")?o.status="ready":o.status=a.state}),o.$watch(function(){return e.current},function(e){n.group("navigationPathMenu").clear(),e?(a.routeChange(e.$$route),e.$$route&&angular.isFunction(e.$$route.integerate)&&i.invoke(e.$$route.integerate,e.$$route)):a.routeChange(e)}),t.$watch("app.state.status",function(e){a.appStateChange(e)}),o.$watch("app.user.anonymous",function(e){a.userStateChange(e)})}}}]),angular.module("mblowfish-core").directive("mbPay",["$bank","$parse","$location","$navigator","$translate","QueryParameter",function(e,t,n,i,r,o){var a=new o;return{replace:!0,restrict:"E",templateUrl:"views/directives/mb-pay.html",scope:{mbCallbackUrl:"@?",mbPay:"@",mbDiscountEnable:"="},link:function(o,l,s,c){var u=c[0],d=this;u.$render=function(){d.currency=u.$modelValue,d.currency&&d.loadGates()},this.loadGates=function(){if(!this.loadingGates){this.loadingGates=!0,a.setFilter("currency",this.currency);var t=this;return e.getBackends(a).then(function(e){return t.gates=e.items,e}).finally(function(){t.loadingGates=!1})}},this.pay=function(e,a){if(!this.paying){this.paying=!0;var l={backend:e.id,callback:s.mbCallbackUrl?s.mbCallbackUrl:n.absUrl()};void 0!==a&&null!==a&&(l.discount_code=a);var c=this;t(s.mbPay)(o.$parent,{$backend:e,$discount:a,$callback:l.callback,$data:l}).then(function(e){c.paying=!1,i.openPage("bank/receipts/"+e.id)},function(e){c.paying=!1,alert(r.instant(e.data.message))})}},o.ctrl=this},require:["ngModel"]}}]),angular.module("mblowfish-core").directive("mbPreferencePage",["$compile","$controller","$preferences","$wbUtil","$rootScope","$mdTheming",function(e,t,n,i,r,o){return{restrict:"E",templateUrl:"views/directives/mb-preference-page.html",replace:!0,scope:{mbPreferenceId:"="},link:function(a,l){var s=l;a.$watch("mbPreferenceId",function(l){l&&n.page(l).then(function(n){!function(n,a,l){var s=n.$new(!1,n);s.app=r.app,i.getTemplateFor(a).then(function(n){var i=angular.element(n),r=e(i);if(angular.isDefined(a.controller)){var c={$scope:s,$element:i},u=t(a.controller,c);a.controllerAs&&(s[a.controllerAs]=u),i.data("$ngControllerController",u)}l.empty(),l.append(r(s)),o(i)})}(a,n,s)},function(){})})}}}]),angular.module("mblowfish-core").directive("mbPreloading",function(){var e="mb-preload",t="mb-preload-animate";return{restrict:"A",link:function(n,i,r){!function(e,n){n.addClass(t)}(0,i),n.$watch(function(){return n.$eval(r.mbPreloading)},function(t){t?function(t,n,i){i.mbPreloadingClass&&n.addClass(i.mbPreloadingClass),n.addClass(e)}(0,i,r):function(t,n,i){i.mbPreloadingClass&&n.addClass(i.mbPreloadingClass),n.removeClass(e)}(0,i,r)})}}}),angular.module("mblowfish-core").directive("mbTitledBlock",function(){return{replace:!0,restrict:"E",transclude:!0,scope:{mbTitle:"@?",mbIcon:"@?",mbProgress:"<?",mbMoreActions:"="},templateUrl:"views/directives/mb-titled-block.html"}}),angular.module("mblowfish-core").directive("mbTreeHeading",function(){return{restrict:"E",replace:!0,scope:{mbSection:"="},templateUrl:"views/directives/mb-tree-heading.html"}}),angular.module("mblowfish-core").directive("mbTreeLink",function(){return{restrict:"E",scope:{mbSection:"="},templateUrl:"views/directives/mb-tree-link.html",controller:["$scope","$navigator",function(e,t){e.isSelected=function(e){return e&&t.isPageSelected(e.link)},e.focusSection=function(e){return t.openPage(e.link)}}]}}),angular.module("mblowfish-core").directive("mbTreeToggle",["$timeout","$animateCss","$mdSidenav","$mdMedia","$rootScope",function(e,t,n,i,r){return{restrict:"E",replace:!0,scope:{mbSection:"="},templateUrl:"views/directives/mb-tree-toggle.html",link:function(n,i,r,o){var a=i.find("ul"),l=function(){var e;return a.addClass("no-transition"),a.css("height",""),e=a.prop("clientHeight"),a.css("height",0),a.removeClass("no-transition"),e};a&&n.$watch(function(){return o.isOpen(n.mbSection)},function(n){e(function(){!function(e){t(a,{from:{height:e?0:l()+"px"},to:{height:e?l()+"px":0},duration:.3}).start()}(n)},0,!1)})},controller:["$scope",function(e){var t=null;angular.isFunction(e.$parent.isOpen)?(e.isOpen=e.$parent.isOpen,e.toggle=e.$parent.toggle):(e.isOpen=function(e){return t===e},e.toggle=function(e){t=t===e?null:e}),this.isOpen=e.isOpen,e.isVisible=function(t){if(!t){for(var n=0;n<e.mbSection.sections.length;n++)if(!r.$eval(e.mbSection.sections[n].hidden))return!0;return!1}return!t.hidden||!r.$eval(t.hidden)}}]}}]),angular.module("mblowfish-core").directive("mbTree",["$animate","$rootScope",function(e,t){return{restrict:"E",replace:!0,scope:{mbSection:"="},templateUrl:"views/directives/mb-tree.html",link:function(e,n){e.isVisible=function(e){return!(!n.has("li").length||e.hidden&&t.$eval(e.hidden))}},controller:["$scope",function(e){var t=null;e.isOpen=function(e){return t===e},e.toggle=function(e){t=t===e?null:e}}]}}]),angular.module("mblowfish-core").directive("mbUserMenu",["$actions","$app","$mdSidenav",function(e,t,n){return{restrict:"E",replace:!0,scope:!0,templateUrl:"views/directives/mb-user-menu.html",link:function(i){i.menu=e.group("mb.user"),i.logout=t.logout,i.settings=function(){return n("settings").toggle()}},controller:"MbAccountCtrl"}}]),angular.module("mblowfish-core").directive("mbUserToolbar",["$actions",function(e){return{restrict:"E",replace:!0,templateUrl:"views/directives/mb-user-toolbar.html",link:function(t){t.menu=e.group("mb.user")},controller:"MbAccountCtrl"}}]),angular.module("mblowfish-core").factory("MbAction",["$injector","$navigator",function(e,t){var n=function(e){return angular.isDefined(e)||(e={}),angular.extend(this,e,{priority:e.priority||10}),this.visible=this.visible||function(){return!0},this};return n.prototype.exec=function(n){this.action?e.invoke(this.action,this):this.url&&t.openPage(this.url),n&&(n.stopPropagation(),n.preventDefault())},n}]),angular.module("mblowfish-core").factory("MbActionGroup",function(){var e=function(e){angular.isDefined(e)||(e={}),angular.extend(this,e,{priority:e.priority||10,items:[]})};return e.prototype.clear=function(){this.items=[]},e}),angular.module("mblowfish-core").factory("MbEvent",function(){var e=function(e){angular.isDefined(e)||(e={}),angular.extend(this,e)};return e.prototype.getType=function(){return this.type||"unknown"},e.prototype.getKey=function(){return this.key||"unknown"},e.prototype.getValues=function(){return this.values||[]},e.prototype.isCreated=function(){return"created"===this.key},e.prototype.isRead=function(){return"read"===this.key},e.prototype.isUpdated=function(){return"updated"===this.key},e.prototype.isDeleted=function(){return"deleted"===this.key},e}),angular.module("mblowfish-core").factory("MbHttpRequestInterceptor",["$q","$injector",function(e,t){"use strict";var n=function(){};return n.prototype.responseError=function(n){var i=t.get("$app");return 401===n.status&&i.logout(),e.reject(n)},n}]),angular.module("mblowfish-core").filter("currencyFilter",["numberFilter","translateFilter",function(e,t){return function(n,i){return n?"iran-rial"===i||"iran-tooman"===i?e(n)+" "+t(i):"bahrain-dinar"===i?e(n)+" "+t("bahrain-dinar"):"euro"===i?e(n)+" "+t("euro"):"dollar"===i?t("dollar")+" "+e(n):"pound"===i?t("pound")+" "+e(n):"iraq-dinar"===i?e(n)+" "+t("iraq-dinar"):"kuwait-dinar"===i?e(n)+" "+t("kuwait-dinar"):"oman-rial"===i?e(n)+" "+t("oman-rial"):"turkish-lira"===i?e(n)+" "+t("turkish-lira"):"uae-dirham"===i?e(n)+" "+t("uae-dirham"):e(n)+" ?":t("free")}}]),angular.module("mblowfish-core").filter("mbDate",["$rootScope",function(e){return function(t,n){if(!t)return"";try{var i=n||e.app.setting.dateFormat||e.app.config.dateFormat||"jYYYY-jMM-jDD hh:mm:ss";return"Jalaali"!==e.app.calendar&&(i=i.replace("j","")),moment.utc(t).local().format(i)}catch(e){return"-"+e.message}}}]),angular.module("mblowfish-core").run(["$notification","$help",function(e,t){window.openHelp=function(e){return t.openHelp(e)},window.alert=e.alert,window.confirm=e.confirm,window.prompt=e.prompt,window.toast=e.toast}]),angular.module("mblowfish-core").run(["$toolbar","$sidenav","$rootScope","$navigator","$route","$actions","$help",function(e,t,n,i,r,o,a){o.newAction({id:"mb.preferences",priority:15,icon:"settings",title:"Preferences",description:"Open preferences panel",visible:function(){return n.app.user.owner},action:function(){return i.openPage("preferences")},groups:["mb.toolbar.menu"]}),o.newAction({id:"mb.help",priority:15,icon:"help",title:"Help",description:"Display help in sidenav",visible:function(){return a.hasHelp(r.current)},action:function(){a.openHelp(r.current)},groups:["mb.toolbar.menu"]}),o.newAction({icon:"account_circle",title:"Profile",description:"User profile",groups:["mb.user"],action:function(){return i.openPage("users/profile")}}),o.newAction({icon:"account_box",title:"Account",description:"User account",groups:["mb.user"],action:function(){return i.openPage("users/account")}}),o.newAction({icon:"fingerprint",title:"Password",description:"Manage password",groups:["mb.user"],action:function(){return i.openPage("users/password")}}),e.newToolbar({id:"dashboard",title:"Dashboard toolbar",description:"Main dashboard toolbar",controller:"MbToolbarDashboardCtrl",templateUrl:"views/toolbars/mb-dashboard.html"}),t.newSidenav({id:"navigator",title:"Navigator",description:"Navigate all path and routs of the pandel",controller:"AmdNavigatorCtrl",templateUrl:"views/sidenavs/mb-navigator.html",locked:!0,position:"start"}),t.newSidenav({id:"help",title:"Help",description:"System online help",controller:"MbHelpCtrl",templateUrl:"views/sidenavs/mb-help.html",locked:!0,visible:function(){return n.showHelp},position:"end"}),t.newSidenav({id:"settings",title:"Options",description:"User options",controller:"MbOptionsCtrl",templateUrl:"views/sidenavs/mb-options.html",locked:!1,position:"end"}),t.newSidenav({id:"messages",title:"Messages",description:"User message queue",controller:"MessagesCtrl",controllerAs:"ctrl",templateUrl:"views/sidenavs/mb-messages.html",locked:!1,position:"start"})}]),angular.module("mblowfish-core").run(["appcache","$window","$rootScope",function(e,t,n){function i(){t.location.reload()}function r(){var t;e.swapCache().then(void((t=n.app.config.update||{}).showMessage?t.autoReload?alert("Application is update. Page will be reload automatically.").then(i):confirm("Application is update. Reload the page for new version?").then(i):toast("Application is updated.")))}n.$watch("app.state.status",function(t){if(t&&t.startsWith("ready"))return e.checkUpdate().then(r)})}]),angular.module("mblowfish-core").run(["$window","$rootScope","$location","$wbLibs",function(e,t,n,i){t.$watch("app.config.crisp.id",function(t){t&&(i.load("https://client.crisp.chat/l.js"),e.$crisp=[],e.CRISP_WEBSITE_ID=t)})}]),angular.module("mblowfish-core").run(["$window","$rootScope","$location","$wbLibs",function(e,t,n,i){var r,o=!1;function a(){var t={page_path:n.path()};e.gtag("config",r,t)}t.$watch("app.config.googleAnalytic.property",function(n){n&&(!function(t){i.load("https://www.googletagmanager.com/gtag/js").then(function(){e.dataLayer=e.dataLayer||[],e.gtag=function(){e.dataLayer.push(arguments)},e.gtag("js",new Date),e.gtag("config",t)})}(n),o||(t.$on("$routeChangeStart",a),o=!0))})}]),angular.module("mblowfish-core").run(["$rootScope","$page","$location",function(e,t,n){e.$on("$routeChangeStart",function(){var n;(n=e.app||{}).config&&(t.setTitle(n.config.title),t.setDescription(n.config.description),t.setKeywords(n.config.keywords),t.setFavicon(n.config.favicon||n.config.logo))}),e.$on("$routeChangeSuccess",function(){var e=n.absUrl();t.setMeta("twitter:url",e).setMeta("og:url",e)}),e.$watch(function(){var t=(e.app||{}).config;return t?t.title+"#"+t.description+"#"+t.keywords+"#"+t.logo+"#"+t.favicon:t},function(){var n,i;n=e.app||{},(i=n.config?n.config:null)&&(t.setTitle(t.getTitle()||i.title),t.setDescription(t.getDescription()||i.description),t.setKeywords(t.getKeywords()||i.keywords),t.setFavicon(i.favicon||i.logo),t.setMeta("og:site_name",i.title))}),t.setMeta("twitter:card","summary"),t.setMeta("og:type","object")}]),angular.module("mblowfish-core").run(["$help","$rootScope","$route",function(e,t,n){t.$watch(function(){return n.current},function(t){e.setCurrentItem(t)})}]),angular.module("mblowfish-core").run(["$resource","$location","$controller",function(e,t,n){function i(){return t.protocol()+"://"+t.host()+(t.port()?":"+t.port():"")}function r(){return this.__selections||(this.__selections=angular.isArray(this.value)?this.value:[]),this.__selections}function o(e,t){if(!angular.isDefined(t.id))return e.indexOf(t);for(var n=0;n<e.length;n++)if(e[n].id===t.id)return n}function a(e,t){var n=this.getSelection(),i=o(n,e);if(t){if(i>=0)return;n.push(e)}else i>-1&&n.splice(i,1)}function l(e){return o(this.getSelection(),e)>=0}e.newPage({label:"Account",type:"account",templateUrl:"views/resources/mb-accounts.html",controller:["$scope",function(e){e.multi=!1,this.value=e.value,this.setSelected=function(t){e.$parent.setValue(t),e.$parent.answer()},this.isSelected=function(e){return e===this.value||e.id===this.value.id}}],controllerAs:"resourceCtrl",priority:8,tags:["account"]}),e.newPage({label:"Accounts",type:"account-list",templateUrl:"views/resources/mb-accounts.html",controller:["$scope",function(e){e.multi=!0,this.value=e.value,this.setSelected=function(t,n){this._setSelected(t,n),e.$parent.setValue(this.getSelection())},this._setSelected=a,this.isSelected=l,this.getSelection=r}],controllerAs:"resourceCtrl",priority:8,tags:["accounts"]}),e.newPage({label:"Role List",type:"role-list",templateUrl:"views/resources/mb-roles.html",controller:["$scope",function(e){e.multi=!0,this.value=e.value,this.setSelected=function(t,n){this._setSelected(t,n),e.$parent.setValue(this.getSelection())},this._setSelected=a,this.isSelected=l,this.getSelection=r}],controllerAs:"resourceCtrl",priority:8,tags:["roles"]}),e.newPage({label:"Group List",type:"group-list",templateUrl:"views/resources/mb-groups.html",controller:["$scope",function(e){e.multi=!0,this.value=e.value,this.setSelected=function(t,n){this._setSelected(t,n),e.$parent.setValue(this.getSelection())},this._setSelected=a,this.isSelected=l,this.getSelection=r}],controllerAs:"resourceCtrl",priority:8,tags:["groups"]}),e.newPage({type:"cms-content-image",icon:"image",label:"Images",templateUrl:"views/resources/mb-cms-images.html",controller:["$scope",function(e){angular.extend(this,n("AmWbSeenCmsContentsCtrl",{$scope:e})),this.setAbsolute=function(e){this.absolute=e},this.isAbsolute=function(){return this.absolute},this.setSelected=function(t){var n="/api/v2/cms/contents/"+t.id+"/content";this.isAbsolute()&&(n=i()+n),this.value=n,e.$parent.setValue(n)},this.init()}],controllerAs:"ctrl",priority:10,tags:["image"]}),e.newPage({type:"content-upload",icon:"file_upload",label:"Upload",templateUrl:"views/resources/mb-cms-content-upload.html",controller:["$scope","$cms","uuid4",function(e,t,r){angular.extend(this,n("AmWbSeenCmsContentsCtrl",{$scope:e})),this.absolute=!1,this.files=[],this.setAbsolute=function(e){this.absolute=e},this.isAbsolute=function(){return this.absolute};var o=this;e.answer=function(){var e={};e.name=this.name||r.generate(),e.description=this.description||"Auto loaded content";var t=null;return angular.isArray(o.files)&&o.files.length&&(t=o.files[0].lfFile,e.title=t.name),o.uploadFile(e,t).then(function(e){var t="/api/v2/cms/contents/"+e.id+"/content";return o.isAbsolute()&&(t=i()+t),t}).catch(function(){alert("Failed to create or upload content")})},this.init()}],controllerAs:"ctrl",priority:1,tags:["image","audio","vedio","file"]})}]),angular.module("mblowfish-core").run(["$options","$preferences",function(e,t){t.newPage({id:"local",title:"local",description:"manage dashboard locality and language.",templateUrl:"views/preferences/mb-local.html",controller:"MbLocalCtrl",icon:"language",tags:["local","language"]}).newPage({id:"brand",title:"Branding",description:"Manage application branding such as title, logo and descritpions.",templateUrl:"views/preferences/mb-brand.html",icon:"copyright",priority:2,required:!0,tags:["brand"]}).newPage({id:"google-analytic",title:"Google Analytic",templateUrl:"views/preferences/mb-google-analytic.html",description:"Enable google analytic for your application.",icon:"timeline",tags:["analysis"]}).newPage({id:"crisp-chat",title:"CRISP chat",templateUrl:"views/preferences/mb-crisp-chat.html",description:"Give your customer messaging experience a human touch with CRISP.",icon:"chat",tags:["chat"]}).newPage({id:"update",templateUrl:"views/preferences/mb-update.html",title:"Update application",description:"Settings of updating process and how to update the application.",icon:"autorenew"}),e.newPage({title:"Local",templateUrl:"views/options/mb-local.html",controller:"MbLocalCtrl",tags:["local"]}),e.newPage({title:"Theme",controller:"MbThemesCtrl",templateUrl:"views/options/mb-theme.html",tags:["theme"]})}]),angular.module("mblowfish-core").service("$actions",["Action","ActionGroup",function(e,t){var n=[],i={},r=[],o=[];function a(e){i[e.id]=null;var t=n.indexOf(e);if(t>-1){n.splice(t,1);for(var r=0;r<e.groups.length;r++){var o=l(e.groups[r]),a=o.items.indexOf(e);a>-1&&o.items.splice(a,1)}return e}}function l(e,n){var i=o[e];return i||((i=new t).id=e,o[i.id]=i,r.push(i)),n&&angular.extend(i,n),i}return{actions:function(){return{items:n}},newAction:function(t){var r=new e(t);i[r.id]=r,n.push(r);for(var o=0;o<r.groups.length;o++)l(r.groups[o]).items.push(r);return r.scope&&r.scope.$on("$destroy",function(){a(r)}),r},action:function(e){var t=i[e];if(t)return t},removeAction:a,groups:function(){return{items:r}},newGroup:function(e){return l(e.id,e)},group:l}}]),angular.module("mblowfish-core").service("$app",["$rootScope","$usr","$q","$cms","$translate","$http","$httpParamSerializerJQLike","$mdDateLocale","$localStorage","QueryParameter","$tenant",function(e,t,n,i,r,o,a,l,s,c,u){var d,m="angular-material-blowfish-",p="application/amd-cnf",g="{id, login, profiles{first_name, last_name, language, timezone}, roles{id, application, code_name}, groups{id, name, roles{id, application, code_name}}}",f=(new c).put("graphql","{items{id, key,value}}"),h={state:{status:"loading",stage:"starting",message:null},logs:[],user:{current:{},profile:{},anonymous:!0,administrator:!1,owner:!1,member:!1,authorized:!1},config:{},setting:{},options:{}};e.app=h;var b=!1,v=!1,w={user_loaded:!1,options_loaded:!1,configs_loaded:!1};function y(e,t){h.state.stage=e,h.state.message=t,t&&h.logs.push(t)}function $(e){for(var t=0;t<e.length;t++){var n=e[t];h.user[n.application+"_"+n.code_name]=!0}}function k(){return y("loading user info","fetch user information"),t.getAccount("current",{graphql:g}).then(function(e){if(w.user_loaded=!0,h.user={anonymous:!e.id||0===e.id,current:e},angular.isArray(e.profiles)&&(h.user.profile=e.profiles.length?e.profiles[0]:{}),y("loading user info","user information loaded successfully"),y("loading user info","check user permissions"),!h.user.anonymous){$(e.roles);for(var t=0;t<e.groups.length;t++)$(e.groups[t].roles);e.isAnonymous()?h.user.anonymous=!0:(h.user.owner=h.user.tenant_owner||h.user.core_owner||h.user.Pluf_owner||h.user.Core_owner,h.user.administrator=h.user.owner)}d.loaded()},function(e){w.user_loaded=!1,d.error(e)})}return(d=new machina.Fsm({initialize:function(){h.state.status="waiting"},namespace:"webpich.$app",initialState:"waiting",states:{waiting:{start:"loading",network_error:"offline",server_error:"fail"},loading:{_onEnter:function(){k(),y("loading options","fetch options document"),h.options={},u.getSettings(f).then(function(e){for(var t=0;t<e.items.length;t++){var n=e.items[t];h.options[n.key]=n.value}w.options_loaded=!0,d.loaded()},function(e){d.error(e)}),y("loading setting from local storage","fetch settings"),h.setting=s.$default({dashboardModel:{}}),y("setting loaded","fetch settings"),y("loading configuration","fetch configuration document"),w.configs_loaded=!1,w.configs_fail=!1,i.getContent(m+h.key).then(function(e){return y("loading configuration","fetch configuration content"),h._acc=e,h._acc.downloadValue()},function(e){return w.configs_fail=!0,d.error(e),{}}).then(function(e){h.config=angular.isObject(e)?e:{}}).finally(function(){w.configs_loaded=!0,d.loaded()})},loaded:function(){w.user_loaded&&w.options_loaded&&w.configs_loaded?this.transition("ready"):w.user_loaded&&w.options_loaded&&w.configs_fail&&this.transition("ready_not_configured")},server_error:"fail",network_error:"offline"},ready:{network_error:"offline"},ready_not_configured:{loaded:function(){w.configs_loaded&&this.transition("ready")},network_error:"offline"},fail:{},offline:{}},loaded:function(){this.handle("loaded")},start:function(){this.handle("start")},error:function(e){404===e.status?this.handle("resource_not_found"):500===e.status?this.handle("server_error"):-1===e.status&&this.handle("network_error")}})).on("transition",function(){y("$app event handling","$app state is changed from "+h.state.status+" to "+d.state),h.state.status=d.state}),e.$watch(function(){return h.config.local||(h.config.local={}),h.setting.dir||h.config.local.dir},function(e){h.dir=e}),e.$watch(function(){return angular.isObject(h.config.local)||(h.config.local={}),h.setting.local||h.config.local.language||"en"},function(e){h.local=e,r.use(e),moment.loadPersian(),moment.locale(e);var t=moment.localeData();l.months=t._months,l.shortMonths=t._monthsShort,l.days=t._weekdays,l.shortDays=t._weekdaysMin,l.firstDayOfWeek=t._week.dow}),e.$watch(function(){return h.setting.calendar||h.config.calendar||"Gregorian"},function(e){h.calendar=e}),e.$watch("app.config",function(){"ready"!==h.state.status&&"ready_not_configured"!==h.state.status||function e(){var t;if(v=!0,!b)return h.user.core_owner||h.user.Pluf_owner||h.user.tenant_owner?(b=!0,h._acc?(v=!1,t=h._acc.uploadValue(h.config)):t=i.putContent({name:m+h.key,mimetype:p}).then(function(e){return v=!1,h._acc=e,d.loaded(),h._acc.uploadValue(h.config)},function(e){d.error(e)}),t.finally(function(){if(b=!1,v)return e()})):n.reject({data:{message:"fail"}})}()},!0),this.start=function(e){h.key=e,d.start()},this.login=function(e){return h.user.anonymous?o({method:"POST",url:"/api/v2/user/login",data:a(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(){k()}):n.resolve(h.user.current)},this.logout=function(){var t=e.app.user;return t.anonymous?n.resolve(t):(e.app.user={},d.loaded(),o({method:"POST",url:"/api/v2/user/logout",headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(){k()},function(){e.app.user=t,d.loaded()}))},this}]),angular.module("mblowfish-core").service("$errorHandler",function(){return{handleError:function(e,t){var n=null;return 400===e.status&&t?(n="Form is not valid. Fix errors and retry.",e.data.data.forEach(function(e){t[e.name].$error={},e.constraints.map(function(n){t[e.name]&&(t[e.name].$error[n.toLowerCase()]=!0)})})):n=e.data.message,n}}}),angular.module("mblowfish-core").service("$amdExport",["FileSaver","$q","QueryParameter",function(e,t,n){return{list:function(t,n,i,r,o){var a=new i;a.put("_px_q ",i.get("_px_q")),a.put("_px_sk ",i.get("_px_sk")),a.put("_px_so ",i.get("_px_so")),a.put("_px_fk ",i.get("_px_fk")),a.put("_px_fv ",i.get("_px_fv")),a.setPage(0);var l,s="";function c(i){if(s+=function(e){var t="";return angular.forEach(e.items,function(e){var n="";angular.forEach(l,function(t){n=n+(e[t]||" ")+","}),t=t+n.slice(0,-1)+"\n"}),t}(i),!i.hasMore()){var u=new Blob([s],{type:"text/plain;charset=utf-8"});return e.saveAs(u,o+"."+r)}return a.setPage(i.next()),n.apply(t,[a]).then(c)}return n.apply(t,[a]).then(function(e){if(!l){var t=Object.keys(e.items[0]);l=[],angular.forEach(t,function(t){angular.isFunction(e.items[0][t])||angular.isObject(e.items[0][t])||l.push(t)})}var n="";return angular.forEach(l,function(e){n=n+e+","}),s=n.slice(0,-1)+"\n",c(e)})}}}]),angular.module("mblowfish-core").service("$help",["$q","$rootScope","$translate","$injector",function(e,t,n,i){var r=[],o=null;function a(e){if(!e)return null;var t=e.helpId;return angular.isFunction(e.helpId)?i.invoke(e.helpId,e):t}function l(e){o=e}function s(e){return!!a(e)}return{tip:function(e){return r.push(e),this},tips:function(){return e.resolve({items:r})},currentItem:function(){return o},setCurrentItem:l,openHelp:function(e){s(e)&&(o!==e?(l(e),t.showHelp=!0):t.showHelp=!t.showHelp)},hasHelp:s,getHelpPath:function(e){var t=a(e||o);return t?"resources/helps/"+t+"-"+n.use()+".json":null}}}]),angular.module("mblowfish-core").service("$language",["$rootScope","$q","$translate",function(e,t,n){return{language:function(t){var n=e.app.config.languages;if(n&&n.length)for(var i=0;i<n.length;i++)if(n[i].key===t)return n[i]},languages:function(){var n={items:e.app.config.languages||[]};return t.when(n)},newLanguage:function(i){if(!e.app.user.owner)return t.reject("not allowed");if(e.app.config.languages){for(var r=e.app.config.languages,o=0;o<r.length;o++)if(i.key===r[o].key)return t.reject("Sorry! Languages with the same key are not allowed.")}else e.app.config.languages=[];return e.app.config.languages.push(i),n.refresh(i.key),t.resolve(i)},deleteLanguage:function(n){if(!e.app.user.owner)return t.reject("not allowed");var i=e.app.config.languages;if(!i||!i.length)return t.reject("Not found");var r=-1;if(angular.isString(n)){for(var o=0;o<i.length;o++)if(i[o].key===n){r=o;break}}else r=i.indexOf(n);return-1!==r?(i.splice(r,1),t.resolve(n)):t.reject("Not found")},proposedLanguage:function(){return n.proposedLanguage()},refresh:function(e){return n.refresh(e)},use:function(e){return n.use(e)}}}]),angular.module("mblowfish-core").service("$metrics",["$q",function(e){this.breakMonitor=function(){},this.trackMetric=function(){return e.resolve("hi")}}]),angular.module("mblowfish-core").service("$navigator",["$q","$route","$mdDialog","$location","$window",function(e,t,n,i,r){var o=[],a=[];function l(e){var t=o;return e&&e.param._px_fk&&(t=[],"group"===e.param._px_fk&&angular.forEach(o,function(n){n.groups&&angular.isArray(n.groups)&&n.groups.indexOf(e.param._px_fv)>-1&&t.push(n)})),t}return{loadAllItems:function(t){e.resolve(l(t))},openDialog:function(e){var t={};return angular.extend(t,{controller:e.controller||"AmdNavigatorDialogCtrl",controllerAs:e.ctrl||"ctrl",parent:angular.element(document.body),clickOutsideToClose:!0,fullscreen:!0,multiple:!0},e),t.config||(t.config={}),t.locals||(t.locals={}),t.locals.config=t.config,n.show(t)},openPage:function(e,t){e&&e.toLowerCase().startsWith("http")&&r.open(e),t?i.path(e).search(t):i.path(e)},isPageSelected:function(){return!1},items:l,newItem:function(e){return e.priority=e.priority||100,o.push(e),this},deleteItem:function(e){var t=o.indexOf(e);return t>-1&&o.splice(t,1),this},groups:function(){return a},newGroup:function(e){e.id in a||(a[e.id]={id:e.id}),angular.merge(a[e.id],e)},group:function(e){return e in a||(a[e]={id:e}),a[e]}}}]),angular.module("mblowfish-core").service("$notification",["$navigator","$mdToast",function(e,t){return{toast:function(e){return t.show(t.simple().textContent(e).hideDelay(3e3))},alert:function(t){return e.openDialog({templateUrl:"views/dialogs/mb-alert.html",config:{message:t}}).then(function(){return!0},function(){return!0})},prompt:function(t,n){return e.openDialog({templateUrl:"views/dialogs/mb-prompt.html",config:{message:t,model:n}})},confirm:function(t){return e.openDialog({templateUrl:"views/dialogs/mb-confirm.html",config:{message:t}})}}}]),angular.module("mblowfish-core").service("$options",["$q",function(e){var t=[];var n={pages:function(){return e.when({items:t})},page:function(n){for(var i=0;i<t.length;i++)if(t[i].id===n)return e.when(t[i]);return e.reject({})},newPage:function(e){return t.push(e),n}};return n}]),angular.module("mblowfish-core").service("$page",["$rootScope","$rootElement",function(e,t){e.page={title:"",description:"",keywords:[],links:[]};var n=e.page,i=t.find("head"),r=t.find("body");return this.setTitle=function(e){return n.title=e,function(e){var t=i.find(e);if(t.length)return angular.element(t[0]);var n=angular.element("<"+e+"/>");return i.append(n),n}("title").text(e),this.setMeta("twitter:title",e),this.setMeta("og:title",e),this},this.getTitle=function(){return n.title},this.setDescription=function(e){return n.description=e,this.setMeta("description",e),this.setMeta("twitter:description",e),this.setMeta("og:description",e),this},this.getDescription=function(){return n.description},this.setKeywords=function(e){return n.keywords=e,this.setMeta("keywords",e),this},this.getKeywords=function(){return n.keywords},this.setFavicon=function(e){return this.updateLink("favicon-link",{href:e,rel:"icon"}),this},this.setCover=function(e){return this.setMeta("twitter:image",e),this.setMeta("og:image",e),this},this.setCanonicalLink=function(e){return this.setLink("canonical",{href:e,rel:"canonical"}),this},this.updateLink=function(e,t){var n,r=e.replace(new RegExp(":","g"),"\\:"),o=i.find("link[key="+r+"]");for(var a in 0===o.length?(n=angular.element("<link key='"+e+"' />"),i.append(n)):n=angular.element(o[0]),t)n.attr(a,t[a]);return this},this.setLink=this.updateLink,this.setMeta=function(e,t){var n,r=e.replace(new RegExp(":","g"),"\\:"),o=i.find("meta[name="+r+"]");return 0===o.length?(n=angular.element("<meta name='"+e+"' content='' />"),i.append(n)):n=angular.element(o[0]),n.attr("content",t),this},this.setLanguage=function(e){return r.attr("lang",e),this},this}]),angular.module("mblowfish-core").service("$preferences",["$q","$navigator",function(e,t){var n=[];function i(e,t){return e.priority===t.priority?0:"first"===e.priority||"last"===t.priority?-1:"last"===e.priority||"first"===t.priority?1:void 0===e.priority?1:void 0===t.priority?-1:e.priority-t.priority}return{pages:function(){return n.sort(i),e.when({items:n})},page:function(t){for(var i=0,r=n.length;i<r;i++)if(n[i].id===t)return e.when(n[i]);return e.reject({message:"Not found"})},newPage:function(e){return n.push(e),this},openPage:function(e){return t.openPage("/preferences/"+e.id)}}}]),angular.module("mblowfish-core").service("$sidenav",["$q",function(e){var t=[];var n=[];var i={sidenavs:function(){return e.when({items:t})},newSidenav:function(e){t.push(e)},sidenav:function(n){for(var i=0;i<t.length;i++)if(t[i].id===n)return e.when(t[i]);return e.reject("Sidenav not found")},setDefaultSidenavs:function(e){return n=e||[],this},defaultSidenavs:function(){return n}};return i}]),angular.module("mblowfish-core").service("$toolbar",["$q",function(e){var t=[];var n=[];var i={toolbars:function(){return e.when({items:t})},newToolbar:function(e){t.push(e)},toolbar:function(n){for(var i=0;i<t.length;i++)if(t[i].id===n)return e.when(t[i]);return e.reject("Toolbar not found")},setDefaultToolbars:function(e){return n=e||[],this},defaultToolbars:function(){return n}};return i}]),angular.module("mblowfish-core").run(["$templateCache",function(e){"use strict";e.put("views/dialogs/mb-alert.html",'<md-dialog layout=column ng-cloak> <md-toolbar> <div class=md-toolbar-tools> <wb-icon>error</wb-icon> <h2 translate>{{app.title}}</h2> <span flex></span> <md-button class=md-icon-button ng-click=cancel()> <wb-icon aria-label="Close dialog">close</wb-icon> </md-button> </div> </md-toolbar> <md-dialog-content layout=row layout-padding layout-align="center center" flex> <p translate>{{config.message}}</p> </md-dialog-content> </md-dialog>'),e.put("views/dialogs/mb-confirm.html",'<md-dialog layout=column ng-cloak> <md-toolbar> <div class=md-toolbar-tools> <wb-icon>warning</wb-icon> <h2 translate>{{app.title}}</h2> <span flex></span> <md-button class=md-icon-button ng-click=answer(true)> <wb-icon aria-label=Done>done</wb-icon> </md-button> <md-button class=md-icon-button ng-click=cancel()> <wb-icon aria-label="Close dialog">close</wb-icon> </md-button> </div> </md-toolbar> <md-dialog-content layout=row layout-padding layout-align="center center" flex> <p translate>{{config.message}}</p> </md-dialog-content> </md-dialog>'),e.put("views/dialogs/mb-prompt.html",'<md-dialog layout=column ng-cloak> <md-toolbar> <div class=md-toolbar-tools> <wb-icon>input</wb-icon> <h2 translate>{{app.title}}</h2> <span flex></span> <md-button class=md-icon-button ng-click=answer(config.model)> <wb-icon aria-label=Done>done</wb-icon> </md-button> <md-button class=md-icon-button ng-click=cancel()> <wb-icon aria-label="Close dialog">close</wb-icon> </md-button> </div> </md-toolbar> <md-dialog-content layout=column layout-padding layout-align="center stretch" flex> <p translate>{{config.message}}</p> <md-input-container class=md-block> <label translate>Input value</label> <input ng-model=config.model> </md-input-container> </md-dialog-content> </md-dialog>'),e.put("views/directives/mb-captcha.html","<div>  <div vc-recaptcha ng-model=ctrl.captchaValue theme=\"app.captcha.theme || 'light'\" type=\"app.captcha.type || 'image'\" key=app.captcha.key lang=\"app.captcha.language || 'fa'\"> </div>  </div>"),e.put("views/directives/mb-dynamic-form.html",'<div layout=column ng-repeat="prop in mbParameters track by $index"> <md-input-container> <label>{{prop.title}}</label> <input ng-required="{{prop.validators && prop.validators.indexOf(\'NotNull\')>-1}}" ng-model=values[prop.name] ng-change="modelChanged(prop.name, values[prop.name])"> </md-input-container> </div>'),e.put("views/directives/mb-dynamic-tabs.html",'<div layout=column> <md-tabs md-selected=pageIndex> <md-tab ng-repeat="tab in mbTabs"> <span translate>{{tab.title}}</span> </md-tab> </md-tabs> <div id=mb-dynamic-tabs-select-resource-children> </div> </div>'),e.put("views/directives/mb-inline.html",'<div ng-switch=mbInlineType>                                                                                                                                                                       <div ng-switch-default> <input wb-on-enter=ctrlInline.save() wb-on-esc=ctrlInline.cancel() ng-model=ctrlInline.model ng-show=ctrlInline.editMode> <button ng-if="mbInlineCancelButton && ctrlInline.editMode" ng-click=ctrlInline.cancel()>cancel</button> <button ng-if="mbInlineSaveButton && ctrlInline.editMode" ng-click=ctrlInline.save()>save</button> <ng-transclude ng-hide=ctrlInline.editMode ng-click=ctrlInline.edit() flex></ng-transclude> </div>  <div ng-messages=errorObject> <div ng-message=error class=md-input-message-animation style="margin: 0px" translate>{{errorObject.errorMessage}}</div> </div> </div>'),e.put("views/directives/mb-navigation-bar.html","<div class=mb-navigation-path-bar md-colors=\"{'background-color': 'primary'}\" layout=row> <div layout=row> <md-button ng-click=goToHome() aria-label=Home class=\"mb-navigation-path-bar-item mb-navigation-path-bar-item-home\"> <md-tooltip ng-if=menu.tooltip md-delay=1500>{{'home' | translate}}</md-tooltip> <wb-icon>home</wb-icon> </md-button> </div> <div layout=row data-ng-repeat=\"menu in pathMenu.items | orderBy:['-priority']\"> <wb-icon>{{app.dir==='rtl' ? 'chevron_left' : 'chevron_right'}}</wb-icon> <md-button ng-show=isVisible(menu) ng-href={{menu.url}} ng-click=menu.exec($event); class=mb-navigation-path-bar-item> <md-tooltip ng-if=menu.tooltip md-delay=1500>{{menu.description}}</md-tooltip> <wb-icon ng-if=menu.icon>{{menu.icon}}</wb-icon> {{menu.title | translate}} </md-button>  </div> </div>"),e.put("views/directives/mb-pagination-bar.html",'<div layout=column> <div class=wrapper-stack-toolbar-container>  <div md-colors="{background: \'primary-hue-1\'}"> <div class=md-toolbar-tools> <md-button ng-if=mbIcon md-no-ink class=md-icon-button aria-label={{::mbIcon}}> <wb-icon>{{::mbIcon}}</wb-icon> </md-button> <h2 flex md-truncate ng-if=mbTitle>{{::mbTitle}}</h2> <md-button ng-if=mbReload class=md-icon-button aria-label=Reload ng-click=__reload()> <wb-icon>repeat</wb-icon> </md-button> <md-button ng-show=mbSortKeys class=md-icon-button aria-label=Sort ng-click="showSort = !showSort"> <wb-icon>sort</wb-icon> </md-button> <md-button ng-show=filterKeys class=md-icon-button aria-label=Sort ng-click="showFilter = !showFilter"> <wb-icon>filter_list</wb-icon> </md-button> <md-button ng-show=mbEnableSearch class=md-icon-button aria-label=Search ng-click="showSearch = true; focusToElement(\'searchInput\');"> <wb-icon>search</wb-icon> </md-button> <md-button ng-if=exportData class=md-icon-button aria-label=Export ng-click=exportData()> <wb-icon>save</wb-icon> </md-button> <span flex ng-if=!mbTitle></span> <md-menu ng-show=mbMoreActions.length> <md-button class=md-icon-button aria-label=Menu ng-click=$mdOpenMenu($event)> <wb-icon>more_vert</wb-icon> </md-button> <md-menu-content width=4> <md-menu-item ng-repeat="item in mbMoreActions"> <md-button ng-click=item.action() aria-label={{::item.title}}> <wb-icon ng-show=item.icon>{{::item.icon}}</wb-icon> <span translate="">{{::item.title}}</span> </md-button> </md-menu-item> </md-menu-content> </md-menu> </div> </div>  <div class="stack-toolbar new-box-showing-animation" md-colors="{background: \'primary-hue-2\'}" ng-show=showSearch> <div class=md-toolbar-tools> <md-button style=min-width:0px ng-click="showSearch = false" aria-label=Back> <wb-icon class=icon-rotate-180-for-rtl>arrow_back</wb-icon> </md-button> <md-input-container flex md-theme=dark md-no-float class="md-block fit-input"> <input id=searchInput placeholder="{{::\'Search\'|translate}}" ng-model=query.searchTerm ng-change=searchQuery() ng-model-options="{debounce: 1000}"> </md-input-container> </div> </div>  <div class="stack-toolbar new-box-showing-animation" md-colors="{background: \'primary-hue-2\'}" ng-show=showSort> <div class=md-toolbar-tools> <md-button style=min-width:0px ng-click="showSort = false" aria-label=Back> <wb-icon class=icon-rotate-180-for-rtl>arrow_back</wb-icon> </md-button> <h3 translate="">Sort</h3> <span style="width: 10px"></span>  <md-menu> <md-button layout=row style="text-transform: none" ng-click=$mdMenu.open()> <h3>{{mbSortKeysTitles ? mbSortKeysTitles[mbSortKeys.indexOf(query.sortBy)] : query.sortBy | translate}}</h3> </md-button> <md-menu-content width=4> <md-menu-item ng-repeat="key in mbSortKeys"> <md-button ng-click="query.sortBy = key; setSortOrder()"> <wb-icon ng-if="query.sortBy === key">check_circle</wb-icon> <wb-icon ng-if="query.sortBy !== key">radio_button_unchecked</wb-icon> {{::mbSortKeysTitles ? mbSortKeysTitles[$index] : key|translate}} </md-button> </md-menu-item> </md-menu-content> </md-menu>  <md-menu> <md-button layout=row style="text-transform: none" ng-click=$mdMenu.open()> <wb-icon ng-if=!query.sortDesc class=icon-rotate-180>filter_list</wb-icon> <wb-icon ng-if=query.sortDesc>filter_list</wb-icon> {{query.sortDesc ? \'Descending\' : \'Ascending\'|translate}} </md-button> <md-menu-content width=4> <md-menu-item> <md-button ng-click="query.sortDesc = false;setSortOrder()"> <wb-icon ng-if=!query.sortDesc>check_circle</wb-icon> <wb-icon ng-if=query.sortDesc>radio_button_unchecked</wb-icon> {{::\'Ascending\'|translate}} </md-button> </md-menu-item> <md-menu-item> <md-button ng-click="query.sortDesc = true;setSortOrder()"> <wb-icon ng-if=query.sortDesc>check_circle</wb-icon> <wb-icon ng-if=!query.sortDesc>radio_button_unchecked</wb-icon> {{::\'Descending\'|translate}} </md-button> </md-menu-item> </md-menu-content> </md-menu> </div> </div>  <div class="stack-toolbar new-box-showing-animation" md-colors="{background: \'primary-hue-2\'}" ng-show=showFilter> <div layout=row layout-align="space-between center" class=md-toolbar-tools> <div layout=row> <md-button style=min-width:0px ng-click="showFilter = false" aria-label=Back> <wb-icon class=icon-rotate-180-for-rtl>arrow_back</wb-icon> </md-button> <h3 translate="">Filters</h3> </div> <div layout=row> <md-button ng-if="filters && filters.length" ng-click=applyFilter() class=md-icon-button> <wb-icon>done</wb-icon> </md-button> <md-button ng-click=addFilter() class=md-icon-button> <wb-icon>add</wb-icon> </md-button> </div> </div> </div> </div>  <div layout=column md-colors="{background: \'primary-hue-1\'}" ng-show="showFilter && filters.length>0" layout-padding>  <div ng-repeat="filter in filters track by $index" layout=row layout-align="space-between center" style="padding-top: 0px;padding-bottom: 0px"> <div layout=row style="width: 50%"> <md-input-container style="padding: 0px;margin: 0px;width: 20%"> <label translate="">Key</label> <md-select name=filter ng-model=filter.key ng-change="showFilterValue=true;" required> <md-option ng-repeat="key in filterKeys" ng-value=key> <span translate="">{{key}}</span> </md-option> </md-select> </md-input-container> <span flex=5></span> <md-input-container style="padding: 0px;margin: 0px" ng-if=showFilterValue> <label translate="">Value</label> <input ng-model=filter.value required> </md-input-container> </div> <md-button ng-if=showFilterValue ng-click=removeFilter(filter,$index) class=md-icon-button> <wb-icon>delete</wb-icon> </md-button> </div> </div> </div>'),e.put("views/directives/mb-panel.html",'<div id=mb-panel-root md-theme="{{app.setting.theme|| app.config.theme || \'default\'}}" md-theme-watch ng-class="{\'mb-rtl-direction\': app.dir === \'rtl\', \'mb-ltr-direction\': app.dir !== \'rtl\'}" dir={{app.dir}} layout=column layout-fill>  <div id=mb-panel-root-ready mb-panel-toolbar-anchor ng-if="status === \'ready\'" layout=column layout-fill>   <div id=mb-panel-root-ready-anchor mb-panel-sidenav-anchor layout=row flex> <md-whiteframe layout=row id=main class="md-whiteframe-24dp main mb-page-content" ng-view flex> </md-whiteframe> </div> </div> <div id=mb-panel-root-access-denied ng-if="status === \'accessDenied\'" layout=column layout-fill> Access Denied </div> <div ng-if="status === \'loading\'" layout=column layout-align="center center" layout-fill> <h3>Loading...</h3>   <md-progress-linear style="width: 50%" md-mode=indeterminate> </md-progress-linear> <md-button ng-if="app.state.status === \'fail\'" class="md-raised md-primary" ng-click=restart() aria-label=Retry> <wb-icon>replay</wb-icon> retry </md-button> </div> <div ng-if="status === \'login\'" layout=row layout-aligne=none layout-align-gt-sm="center center" ng-controller=MbAccountCtrl flex> <div md-whiteframe=3 flex=100 flex-gt-sm=50 layout=column mb-preloading=ctrl.loadUser>  <ng-include src="\'views/partials/mb-branding-header-toolbar.html\'"></ng-include> <md-progress-linear ng-disabled="!(ctrl.loginProcess || ctrl.logoutProcess)" style="margin: 0px; padding: 0px" md-mode=indeterminate class=md-primary md-color> </md-progress-linear>  <div style="text-align: center" layout-margin ng-show="!ctrl.loginProcess && ctrl.loginState === \'fail\'"> <p><span md-colors="{color:\'warn\'}" translate>{{loginMessage}}</span></p> </div> <form name=ctrl.myForm ng-submit=login(credit) layout=column layout-padding> <md-input-container> <label translate>Username</label> <input ng-model=credit.login name=username required> <div ng-messages=ctrl.myForm.username.$error> <div ng-message=required translate>This field is required.</div> </div> </md-input-container> <md-input-container> <label translate>Password</label> <input ng-model=credit.password type=password name=password required> <div ng-messages=ctrl.myForm.password.$error> <div ng-message=required translate>This field is required.</div> </div> </md-input-container>  <div ng-if="app.options[\'captcha.engine\'] === \'recaptcha\'" vc-recaptcha ng-model=credit.g_recaptcha_response theme="app.captcha.theme || \'light\'" type="app.captcha.type || \'image\'" key="app.options[\'captcha.engine.recaptcha.key\']" lang="app.setting.local || app.config.local || \'en\'"> </div> <input hide type="submit"> <div layout=column layout-align=none layout-gt-xs=row layout-align-gt-xs="end center" layout-margin> <a href=users/reset-password style="text-decoration: none" ui-sref=forget flex-order=1 flex-order-gt-xs=-1>{{\'forgot your password?\'| translate}}</a> <md-button ng-disabled=ctrl.myForm.$invalid flex-order=-1 flex-order-gt-xs=1 class="md-primary md-raised" ng-click=login(credit)>{{\'login\'| translate}}</md-button>      </div> </form> </div> </div> </div>'),e.put("views/directives/mb-pay.html",'<div layout=column>  <div layout=column> <md-progress-linear style=min-width:50px ng-if="ctrl.loadingGates || ctrl.paying" md-mode=indeterminate class=md-accent md-color> </md-progress-linear> <div layout=column ng-if="!ctrl.loadingGates && ctrl.gates.length"> <p translate>Select gate to pay</p> <div layout=row layout-align="center center"> <md-button ng-repeat="gate in ctrl.gates" ng-click=ctrl.pay(gate)> <img ng-src={{::gate.symbol}} style="max-height: 64px;border-radius: 4px" alt={{::gate.title}}> </md-button> </div> </div> <div layout=row ng-if="!ctrl.loadingGates && ctrl.gates && !ctrl.gates.length" layout-align="center center"> <p style="color: red"> <span translate>No gate is defined for the currency of the wallet.</span> </p> </div> </div> </div>'),e.put("views/directives/mb-preference-page.html","<div id=mb-preference-body layout=row layout-margin flex> </div>"),e.put("views/directives/mb-titled-block.html",'<div style="border-radius: 5px; margin: 5px 5px 10px 10px; padding: 0px" md-whiteframe=4> <md-toolbar class=md-hue-1 layout=row style="border-top-left-radius: 5px;border-top-right-radius: 5px; margin: 0px; padding: 0px"> <div layout=row layout-align="start center" class=md-toolbar-tools> <wb-icon style="margin: 0" ng-if=mbIcon>{{::mbIcon}}</wb-icon> <h3 translate="">{{::mbTitle}}</h3> </div> <md-menu layout-align="end center" ng-show=mbMoreActions.length> <md-button class=md-icon-button aria-label=Menu ng-click=$mdOpenMenu($event)> <wb-icon>more_vert</wb-icon> </md-button> <md-menu-content width=4> <md-menu-item ng-repeat="item in mbMoreActions"> <md-button ng-click=item.action() aria-label={{::item.title}}> <wb-icon ng-show=item.icon>{{::item.icon}}</wb-icon> <span translate="">{{::item.title}}</span> </md-button> </md-menu-item> </md-menu-content> </md-menu> </md-toolbar> <md-progress-linear ng-if=mbProgress style="margin: 0px; padding: 0px" md-mode=indeterminate class=md-accent md-color> </md-progress-linear> <div style="margin: 8px" ng-transclude></div> </div>'),e.put("views/directives/mb-tree-heading.html",'<h2 md-colors="{color: \'primary.A100\'}" class="mb-tree-heading md-subhead"> <wb-icon ng-if=mbSection.icon>{{mbSection.icon}}</wb-icon> {{mbSection.title}} </h2>'),e.put("views/directives/mb-tree-link.html","<md-button md-colors=\"{backgroundColor: (isSelected(mbSection.state) || $state.includes(mbSection.state)) ? 'primary.800': 'primary'}\" class=\"md-raised md-primary md-hue-1\" ng-click=focusSection(mbSection)> <wb-icon ng-if=mbSection.icon>{{mbSection.icon}}</wb-icon> <span translate>{{mbSection.title}}</span> <span class=md-visually-hidden ng-if=isSelected(mbSection)> current page </span> </md-button>"),e.put("views/directives/mb-tree-toggle.html",'<div ng-show=isVisible()> <md-button class="md-raised md-primary md-hue-1 md-button-toggle" ng-click=toggle(mbSection) aria-controls=docs-menu-{{section.name}} aria-expanded={{isOpen(mbSection)}}> <div flex layout=row> <wb-icon ng-if=mbSection.icon>{{mbSection.icon}}</wb-icon> <span class=mb-toggle-title translate>{{mbSection.title}}</span> <span flex></span> <span aria-hidden=true class=md-toggle-icon ng-class="{toggled : isOpen(mbSection)}"> <wb-icon>keyboard_arrow_up</wb-icon> </span> </div> <span class=md-visually-hidden> Toggle {{isOpen(mbSection)? expanded : collapsed}} </span> </md-button> <ul id=docs-menu-{{mbSection.title}} class=mb-tree-toggle-list> <li ng-repeat="section in mbSection.sections" ng-if=isVisible(section)> <mb-tree-link mb-section=section ng-if="section.type === \'link\'"> </mb-tree-link> </li> </ul> </div>'),e.put("views/directives/mb-tree.html","<ul id=mb-tree-root-element class=mb-tree> <li md-colors=\"{borderBottomColor: 'background-600'}\" ng-repeat=\"section in mbSection.sections | orderBy : 'priority'\" ng-show=isVisible(section)> <mb-tree-heading mb-section=section ng-if=\"section.type === 'heading'\"> </mb-tree-heading> <mb-tree-link mb-section=section ng-if=\"section.type === 'link'\"> </mb-tree-link> <mb-tree-toggle mb-section=section ng-if=\"section.type === 'toggle'\"> </mb-tree-toggle> </li> </ul>"),e.put("views/directives/mb-user-menu.html",'<div md-colors="{\'background-color\': \'primary-hue-1\'}" class=amd-user-menu> <md-menu md-offset="0 20"> <md-button class=amd-user-menu-button ng-click=$mdOpenMenu() aria-label="Open menu"> <img height=32px class=img-circle style="border-radius: 50%; vertical-align: middle" ng-src=/api/v2/user/accounts/{{app.user.current.id}}/avatar ng-src-error="https://www.gravatar.com/avatar/{{app.user.current.id|wbmd5}}?d=identicon&size=32"> <span>{{app.user.profile.first_name}} {{app.user.profile.last_name}}</span> <wb-icon class=material-icons>keyboard_arrow_down</wb-icon> </md-button> <md-menu-content width=3>  <md-menu-item ng-if=menu.items.length ng-repeat="item in menu.items| orderBy:[\'-priority\']"> <md-button ng-click=item.exec($event) translate=""> <wb-icon ng-if=item.icon>{{item.icon}}</wb-icon> <span ng-if=item.title>{{item.title| translate}}</span> </md-button> </md-menu-item> <md-menu-divider ng-if=menu.items.length></md-menu-divider> <md-menu-item> <md-button ng-click=settings()> <span translate="">Settings</span> </md-button> </md-menu-item> <md-menu-item ng-if=!app.user.anonymous> <md-button ng-click=logout()> <span translate="">Logout</span> </md-button> </md-menu-item> <md-menu-item ng-if=app.user.anonymous> <md-button ng-href=users/login> <span translate="">Login</span> </md-button> </md-menu-item> </md-menu-content> </md-menu> </div>'),e.put("views/directives/mb-user-toolbar.html",'<md-toolbar layout=row layout-align="center center"> <img width=80px class=img-circle ng-src=/api/v2/user/accounts/{{app.user.current.id}}/avatar> <md-menu md-offset="0 20"> <md-button class=capitalize ng-click=$mdOpenMenu() aria-label="Open menu"> <span>{{app.user.profile.first_name}} {{app.user.profile.last_name}}</span> <wb-icon class=material-icons>keyboard_arrow_down</wb-icon> </md-button> <md-menu-content width=3>  <md-menu-item ng-if=menu.items.length ng-repeat="item in menu.items | orderBy:[\'-priority\']"> <md-button ng-click=item.exec($event) translate> <wb-icon ng-if=item.icon>{{item.icon}}</wb-icon> <span ng-if=item.title>{{item.title | translate}}</span> </md-button> </md-menu-item> <md-menu-divider></md-menu-divider> <md-menu-item> <md-button ng-click=toggleRightSidebar();logout();>{{\'Logout\' | translate}}</md-button> </md-menu-item> </md-menu-content> </md-menu> </md-toolbar>'),e.put("views/mb-error-messages.html",'<div ng-message=403 layout=column layout-align="center center"> <wb-icon size=64px>do_not_disturb</wb-icon> <strong translate>Access denied</strong> <p translate>You are not allowed to access this item.</p> </div> <div ng-message=404 layout=column layout-align="center center"> <wb-icon size=64px>visibility_off</wb-icon> <strong translate>Not found</strong> <p translate>Requested item not found.</p> </div> <div ng-message=500 layout=column layout-align="center center"> <wb-icon size=64px>bug_report</wb-icon> <strong translate>Server error</strong> <p translate>An internal server error is occurred.</p> </div>'),e.put("views/mb-initial.html",'<div layout=column flex> <md-content layout=column flex> {{basePath}} <mb-preference-page mb-preference-id=currentStep.id> </mb-preference-page> </md-content> <md-stepper id=setting-stepper ng-show=steps.length md-mobile-step-text=false md-vertical=false md-linear=false md-alternative=true> <md-step ng-repeat="step in steps" md-label="{{step.title | translate}}"> </md-step> </md-stepper> </div>'),e.put("views/mb-passowrd-recover.html",' <md-toolbar layout-padding>  <h3>Forget Your PassWord ?</h3> </md-toolbar>  <div layout=column layout-padding> <md-input-container> <label>Username or Email</label> <input ng-model=credit.login required> </md-input-container> </div> <div layout=column layout-align=none layout-gt-sm=row layout-align-gt-sm="space-between center" layout-padding> <a ui-sref=login flex-order=1 flex-order-gt-sm=-1>Back To Login Page</a> <md-button flex-order=0 class="md-primary md-raised" ng-click=login(credit)>Send</md-button> </div>'),e.put("views/mb-preference.html","<md-content layout=column ng-cloak flex> <table> <tr> <td> <wb-icon wb-icon-name={{preference.icon}} size=128> </wb-icon> </td> <td> <h1 translate>{{preference.title}}</h1> <p translate>{{preference.description}}</p> </td> </tr> </table> <mb-preference-page mb-preference-id=preference.id flex> </mb-preference-page> </md-content>"),e.put("views/mb-preferences.html",'<md-content ng-cloak layout-padding flex> <md-grid-list md-cols-gt-md=3 md-cols=3 md-cols-md=1 md-row-height=4:3 md-gutter-gt-md=16px md-gutter-md=8px md-gutter=4px> <md-grid-tile ng-repeat="tile in preferenceTiles" md-colors="{backgroundColor: \'primary-300\'}" md-colspan-gt-sm={{tile.colspan}} md-rowspan-gt-sm={{tile.rowspan}} ng-click=openPreference(tile.page) style="cursor: pointer"> <md-grid-tile-header> <h3 style="text-align: center;font-weight: bold"> <wb-icon>{{tile.page.icon}}</wb-icon> <span translate="">{{tile.page.title}}</span> </h3> </md-grid-tile-header> <p style="text-align: justify" layout-padding translate="">{{tile.page.description}}</p> </md-grid-tile> </md-grid-list> </md-content>'),e.put("views/options/mb-local.html","<md-divider></md-divider> <md-input-container class=md-block> <label translate>Language & Local</label> <md-select ng-model=app.setting.local> <md-option ng-repeat=\"lang in languages\" ng-value=lang.key>{{lang.title | translate}}</md-option> </md-select> </md-input-container> <md-input-container class=md-block> <label translate>Direction</label> <md-select ng-model=app.setting.dir placeholder=Direction> <md-option value=rtl translate>Right to left</md-option> <md-option value=ltr translate>Left to right</md-option> </md-select> </md-input-container> <md-input-container class=md-block> <label translate>Calendar</label> <md-select ng-model=app.setting.calendar placeholder=\"\"> <md-option value=Gregorian translate>Gregorian</md-option> <md-option value=Jalaali translate>Jalaali</md-option> </md-select> </md-input-container> <md-input-container class=md-block> <label translate>Date format</label> <md-select ng-model=app.setting.dateFormat placeholder=\"\"> <md-option value=jMM-jDD-jYYYY translate> {{'2018-01-01' | mbDate:'jMM-jDD-jYYYY'}} </md-option> <md-option value=jYYYY-jMM-jDD translate> {{'2018-01-01' | mbDate:'jYYYY-jMM-jDD'}} </md-option> <md-option value=\"jYYYY jMMMM jDD\" translate> {{'2018-01-01' | mbDate:'jYYYY jMMMM jDD'}} </md-option> </md-select> </md-input-container>"),e.put("views/options/mb-theme.html",'<md-input-container class=md-block> <label translate>Theme</label> <md-select ng-model=app.setting.theme> <md-option ng-repeat="theme in themes" value={{theme.id}} translate>{{theme.label}}</md-option> </md-select> </md-input-container> <md-input-container class=md-block ng-init="app.setting.navigationPath = app.setting.navigationPath || true"> <md-switch class=md-primary name=special ng-model=app.setting.navigationPath> <sapn flex translate>Navigation path</sapn> </md-switch> </md-input-container>'),e.put("views/partials/mb-branding-header-toolbar.html"," <md-toolbar layout=row layout-padding md-colors=\"{backgroundColor: 'primary-100'}\">  <img style=\"max-width: 50%\" height=160 ng-show=app.config.logo ng-src=\"{{app.config.logo}}\"> <div> <h3>{{app.config.title}}</h3> <p>{{ app.config.description | limitTo: 250 }}{{app.config.description.length > 250 ? '...' : ''}}</p> </div> </md-toolbar>"),e.put("views/preferences/mb-brand.html",'<div layout=column layout-margin ng-cloak flex> <md-input-container class=md-block> <label translate>Title</label> <input required md-no-asterisk name=title ng-model="app.config.title"> </md-input-container> <md-input-container class=md-block> <label translate>Description</label> <input md-no-asterisk name=description ng-model="app.config.description"> </md-input-container> <wb-ui-setting-image title=Logo wb-ui-setting-clear-button=true wb-ui-setting-preview=true ng-model=app.config.logo> </wb-ui-setting-image> <wb-ui-setting-image title=Favicon wb-ui-setting-clear-button=true wb-ui-setting-preview=true ng-model=app.config.favicon> </wb-ui-setting-image> </div>'),e.put("views/preferences/mb-crisp-chat.html",'<div layout=column layout-margin ng-cloak flex> <md-input-container class=md-block> <label translate>CRISP site ID</label> <input required md-no-asterisk name=property ng-model="app.config.crisp.id"> </md-input-container> </div>'),e.put("views/preferences/mb-google-analytic.html",'<div layout=column layout-margin ng-cloak flex> <md-input-container class=md-block> <label>Google analytic property</label> <input required md-no-asterisk name=property ng-model="app.config.googleAnalytic.property"> </md-input-container> </div>'),e.put("views/preferences/mb-language.html",' <div layout=column layout-align="center center" layout-margin style="min-height: 300px" flex> <div layout=column layout-align="center start"> <p>{{\'Select default language of site:\' | translate}}</p> <md-checkbox ng-repeat="lang in languages" style="margin: 8px" ng-checked="myLanguage.key === lang.key" ng-click=setLanguage(lang) aria-label={{lang.key}}> {{lang.title | translate}} </md-checkbox> </div> </div>'),e.put("views/preferences/mb-local.html","<div layout=column layout-padding ng-cloak flex> <md-input-container class=\"md-icon-float md-block\"> <label translate>Language</label> <md-select ng-model=app.config.local.language> <md-option ng-repeat=\"lang in languages\" ng-value=lang.key>{{lang.title | translate}}</md-option> </md-select> <wb-icon style=\"cursor: pointer\" ng-click=goToManage()>settings</wb-icon> </md-input-container> <md-input-container class=md-block> <label translate>Direction</label> <md-select ng-model=app.config.local.dir placeholder=Direction> <md-option value=rtl translate>Right to left</md-option> <md-option value=ltr translate>Left to right</md-option> </md-select> </md-input-container> <md-input-container class=md-block> <label translate>Calendar</label> <md-select ng-model=app.config.local.calendar placeholder=\"\"> <md-option value=Gregorian translate>Gregorian</md-option> <md-option value=Jalaali translate>Jalaali</md-option> </md-select> </md-input-container> <md-input-container class=md-block> <label translate>Date format</label> <md-select ng-model=app.config.local.dateFormat placeholder=\"\"> <md-option value=jMM-jDD-jYYYY translate> <span translate>Month Day Year, </span> <span translate>Ex. </span> {{'2018-01-01' | mbDate:'jMM-jDD-jYYYY'}} </md-option> <md-option value=jYYYY-jMM-jDD translate> <span translate>Year Month Day, </span> <span translate>Ex. </span> {{'2018-01-01' | mbDate:'jYYYY-jMM-jDD'}} </md-option> <md-option value=\"jYYYY jMMMM jDD\" translate> <span translate>Year Month Day, </span> <span translate>Ex. </span> {{'2018-01-01' | mbDate:'jYYYY jMMMM jDD'}} </md-option> </md-select> </md-input-container> </div>"),e.put("views/preferences/mb-update.html",'<div layout=column layout-padding ng-cloak flex> <md-switch class=md-secondary ng-model=app.config.update.showMessage aria-label="Show spa update message option"> <p translate="">Show update message to customers</p> </md-switch> <md-switch class=md-secondary ng-model=app.config.update.autoReload ng-disabled=!app.config.update.showMessage aria-label="Automatically reload page option"> <p translate="">Reload the page automatically on update</p> </md-switch> </div>'),e.put("views/resources/mb-accounts.html",'<div ng-controller="MbSeenUserAccountsCtrl as ctrl" ng-init="ctrl.setDataQuery(\'{id, login, is_active, date_joined, last_login, profiles{first_name,last_name}}\')" mb-preloading="ctrl.state === \'busy\'" layout=column flex> <mb-pagination-bar mb-model=ctrl.queryParameter mb-properties=ctrl.properties mb-reload=ctrl.reload() mb-more-actions=ctrl.getActions()> </mb-pagination-bar> <md-content mb-infinate-scroll=ctrl.loadNextPage() layout=column flex> <md-list flex> <md-list-item ng-repeat="user in ctrl.items track by user.id" ng-click="multi || resourceCtrl.setSelected(user)" class=md-3-line> <img class=md-avatar ng-src=/api/v2/user/accounts/{{::user.id}}/avatar ng-src-error="https://www.gravatar.com/avatar/{{ ::user.id | wbmd5 }}?d=identicon&size=32"> <div class=md-list-item-text layout=column> <h4>{{user.login}}</h4> <h3>{{user.profiles[0].first_name}} {{user.profiles[0].last_name}}</h3> </div> <md-checkbox ng-if=multi class=md-secondary ng-init="user.selected = resourceCtrl.isSelected(user)" ng-model=user.selected ng-change="resourceCtrl.setSelected(user, user.selected)"> </md-checkbox> <md-divider md-inset></md-divider> </md-list-item> </md-list> </md-content> </div>'),e.put("views/resources/mb-cms-content-upload.html",'<div layout=column flex> <lf-ng-md-file-input lf-files=ctrl.files accept=image/* progress preview drag flex> </lf-ng-md-file-input>  <div layout=row> <md-checkbox ng-model=_absolutPathFlag ng-change=ctrl.setAbsolute(_absolutPathFlag) aria-label="Abslout path of the image"> <span translate>Absolut path</span> </md-checkbox> </div> </div>'),e.put("views/resources/mb-cms-images.html",'<div layout=column mb-preloading="ctrl.state === \'busy\'" flex> <mb-pagination-bar mb-model=ctrl.queryParameter mb-properties=ctrl.properties mb-reload=ctrl.reload() mb-more-actions=ctrl.getActions()> </mb-pagination-bar> <md-content mb-infinate-scroll=ctrl.loadNextPage() layout=row layout-wrap layout-align="start start" flex> <div ng-click="ctrl.setSelected(pobject, $index, $event);" ng-repeat="pobject in ctrl.items track by pobject.id" style="border: 16px; border-style: solid; border-width: 1px; margin: 8px" md-colors="ctrl.isSelected($index) ? {borderColor:\'accent\'} : {}" ng-if=!listViewMode> <img style="width: 128px; height: 128px" ng-src="{{\'/api/v2/cms/contents/\'+pobject.id+\'/thumbnail\'}}"> </div> <md-list ng-if=listViewMode> <md-list-item ng-repeat="pobject in items track by pobject.id" ng-click="ctrl.setSelected(pobject, $index, $event);" md-colors="ctrl.isSelected($index) ? {background:\'accent\'} : {}" class=md-3-line> <img ng-if="pobject.mime_type.startsWith(\'image/\')" style="width: 128px; height: 128px" ng-src=/api/v2/cms/contents/{{pobject.id}}/thumbnail> <wb-icon ng-if="!pobject.mime_type.startsWith(\'image/\')">insert_drive_file</wb-icon> <div class=md-list-item-text layout=column> <h3>{{pobject.title}}</h3> <h4>{{pobject.name}}</h4> <p>{{pobject.description}}</p> </div> <md-divider md-inset></md-divider> </md-list-item> </md-list>  <div layout=column layout-align="center center"> <md-progress-circular ng-show="ctrl.status === \'working\'" md-diameter=96> Loading ... </md-progress-circular> </div> </md-content>  <div layout=row> <md-checkbox ng-model=_absolutPathFlag ng-change=ctrl.setAbsolute(_absolutPathFlag) aria-label="Abslout path of the image"> <span translate>Absolut path</span> </md-checkbox> </div> </div>'),e.put("views/resources/mb-groups.html",'<div ng-controller="MbSeenUserGroupsCtrl as ctrl" mb-preloading="ctrl.state === \'busy\'" layout=column flex> <mb-pagination-bar mb-model=ctrl.queryParameter mb-properties=ctrl.properties mb-reload=ctrl.reload() mb-more-actions=ctrl.getActions()> </mb-pagination-bar> <md-content mb-infinate-scroll=ctrl.loadNextPage() layout=column flex> <md-list flex> <md-list-item ng-repeat="group in ctrl.items track by group.id" ng-click="multi || resourceCtrl.setSelected(group)" class=md-3-line> <wb-icon>group</wb-icon> <div class=md-list-item-text layout=column> <h3>{{group.name}}</h3> <h4></h4> <p>{{group.description}}</p> </div> <md-checkbox ng-if=multi class=md-secondary ng-init="group.selected = resourceCtrl.isSelected(group)" ng-model=group.selected ng-click="resourceCtrl.setSelected(group, group.selected)"> </md-checkbox> <md-divider md-inset></md-divider> </md-list-item>  </md-list> </md-content> </div>'),e.put("views/resources/mb-roles.html",'<div ng-controller="MbSeenUserRolesCtrl as ctrl" mb-preloading="ctrl.state === \'busy\'" layout=column flex> <mb-pagination-bar mb-model=ctrl.queryParameter mb-properties=ctrl.properties mb-reload=ctrl.reload() mb-more-actions=ctrl.getActions()> </mb-pagination-bar> <md-content mb-infinate-scroll=ctrl.loadNextPage() layout=column flex> <md-list flex> <md-list-item ng-repeat="role in ctrl.items track by role.id" ng-click="multi || resourceCtrl.selectRole(role)" class=md-3-line> <wb-icon>accessibility</wb-icon> <div class=md-list-item-text layout=column> <h3>{{role.name}}</h3> <p>{{role.description}}</p> </div> <md-checkbox class=md-secondary ng-init="role.selected = resourceCtrl.isSelected(role)" ng-model=role.selected ng-click="resourceCtrl.setSelected(role, role.selected)"> </md-checkbox> <md-divider md-inset></md-divider> </md-list-item> </md-list> </md-content> </div>'),e.put("views/resources/mb-sidenav.html",""),e.put("views/sidenavs/mb-help.html",'<md-toolbar class=md-hue-1 layout=column layout-align=center> <div layout=row layout-align="start center"> <md-button class=md-icon-button aria-label=Close ng-click=closeHelp()> <wb-icon>close</wb-icon> </md-button> <span flex></span> <h4 translate>Help</h4> </div> </md-toolbar> <md-content mb-preloading=helpLoading layout-padding flex> <wb-group ng-model=helpContent> </wb-group> </md-content>'),e.put("views/sidenavs/mb-messages.html",'<div mb-preloading="ctrl.state === \'busy\'" layout=column flex>  <mb-pagination-bar mb-title=Messages mb-model=ctrl.queryParameter mb-reload=ctrl.reload() mb-sort-keys=ctrl.getSortKeys() mb-more-actions=ctrl.getMoreActions()> </mb-pagination-bar> <md-content mb-infinate-scroll=ctrl.loadNextPage() layout=column flex> <md-list flex> <md-list-item ng-repeat="message in ctrl.items track by message.id" class=md-3-line> <wb-icon ng-class="">mail</wb-icon> <div class=md-list-item-text> <p>{{::message.message}}</p> </div> <md-button class="md-secondary md-icon-button" ng-click=ctrl.deleteItem(message) aria-label=remove> <wb-icon>delete</wb-icon> </md-button> <md-divider md-inset></md-divider> </md-list-item> </md-list> </md-content> </div>'),e.put("views/sidenavs/mb-navigator.html",'<md-toolbar class=md-whiteframe-z2 layout=column layout-align="start center"> <img width=128px height=128px ng-show=app.config.logo ng-src={{app.config.logo}} style="min-height: 128px; min-width: 128px"> <strong>{{app.config.title}}</strong> <p style="text-align: center">{{ app.config.description | limitTo: 100 }}{{app.config.description.length > 150 ? \'...\' : \'\'}}</p> </md-toolbar> <md-content md-colors="{backgroundColor: \'primary\'}" flex> <mb-tree mb-section=menuItems> </mb-tree> </md-content>'),e.put("views/sidenavs/mb-options.html"," <mb-user-toolbar mb-actions=userActions> </mb-user-toolbar>  <md-content layout-padding> <mb-dynamic-tabs mb-tabs=tabs> </mb-dynamic-tabs> </md-content>"),e.put("views/toolbars/mb-dashboard.html",'<div layout=row layout-align="start center"> <md-button class=md-icon-button hide-gt-sm ng-click=toggleNavigationSidenav() aria-label=Menu> <wb-icon>menu</wb-icon> </md-button> <img hide-gt-sm height=32px ng-if=app.config.logo ng-src="{{app.config.logo}}"> <strong hide-gt-sm style="padding: 0px 8px 0px 8px"> {{app.config.title}} </strong> <mb-navigation-bar hide show-gt-sm ng-show="app.setting.navigationPath !== false"> </mb-navigation-bar> </div> <div layout=row layout-align="end center">  <md-button ng-repeat="menu in scopeMenu.items | orderBy:[\'-priority\']" ng-show=menu.visible() ng-href={{menu.url}} ng-click=menu.exec($event); class=md-icon-button> <md-tooltip ng-if=menu.tooltip md-delay=1500>{{menu.description}}</md-tooltip> <wb-icon ng-if=menu.icon>{{menu.icon}}</wb-icon> </md-button> <md-divider ng-if=scopeMenu.items.length></md-divider> <md-button ng-repeat="menu in toolbarMenu.items | orderBy:[\'-priority\']" ng-show=menu.visible() ng-href={{menu.url}} ng-click=menu.exec($event); class=md-icon-button> <md-tooltip ng-if="menu.tooltip || menu.description" md-delay=1500>{{menu.description | translate}}</md-tooltip> <wb-icon ng-if=menu.icon>{{menu.icon}}</wb-icon> </md-button> <md-button ng-show=messageCount ng-click=toggleMessageSidenav() style="overflow: visible" class=md-icon-button> <md-tooltip md-delay=1500> <span translate="">Display list of messages</span> </md-tooltip> <wb-icon mb-badge={{messageCount}} mb-badge-fill=accent>notifications</wb-icon> </md-button> <mb-user-menu></mb-user-menu> <md-button ng-repeat="menu in userMenu.items | orderBy:[\'-priority\']" ng-show=menu.visible() ng-click=menu.exec($event) class=md-icon-button> <md-tooltip ng-if=menu.tooltip md-delay=1500>{{menu.tooltip}}</md-tooltip> <wb-icon ng-if=menu.icon>{{menu.icon}}</wb-icon> </md-button> </div>'),e.put("views/users/mb-account.html","<md-content mb-preloading=ctrl.loadingUser class=md-padding layout-padding flex> <div layout-gt=row>  <mb-titled-block mb-title=Account mb-progress=ctrl.avatarLoading flex-gt-sm=50> <div layout=column> <md-input-container> <label translate>ID</label> <input ng-model=ctrl.user.id disabled> </md-input-container> <md-input-container> <label translate>Username</label> <input ng-model=ctrl.user.login disabled> </md-input-container> <md-input-container> <label translate>Email</label> <input ng-model=ctrl.user.email type=email disabled> </md-input-container> </div> </mb-titled-block> </div> </md-content>"),e.put("views/users/mb-forgot-password.html",' <md-content layout=row layout-align=none layout-align-gt-sm="center center" flex> <div md-whiteframe=3 style="max-height: none" flex=100 flex-gt-sm=50 layout=column>  <ng-include src="\'views/partials/mb-branding-header-toolbar.html\'"></ng-include> <md-progress-linear ng-disabled=!ctrl.sendingToken style="margin: 0px; padding: 0px" md-mode=indeterminate class=md-primary md-color> </md-progress-linear>  <div layout-margin> <h3 translate>recover password</h3> <p translate>recover password description</p> </div> <div style="text-align: center" layout-margin ng-show=!ctrl.sendingToken> <span ng-show="ctrl.sendTokenState === \'fail\'" md-colors="{color:\'warn\'}" translate>Failed to send token.</span> <span ng-show="ctrl.sendTokenState === \'success\'" md-colors="{color:\'primary\'}" translate>Token is sent.</span> </div> <form name=ctrl.myForm ng-submit=sendToken(credit) layout=column layout-margin> <md-input-container> <label translate>Username</label> <input ng-model=credit.login name=username> </md-input-container> <md-input-container> <label translate>Email</label> <input ng-model=credit.email name=email type=email> <div ng-messages=ctrl.myForm.email.$error> <div ng-message=email translate>Email is not valid.</div> </div> </md-input-container>     <div ng-if="app.captcha.engine===\'recaptcha\'" vc-recaptcha ng-model=credit.g_recaptcha_response theme="app.captcha.theme || \'light\'" type="app.captcha.type || \'image\'" key=app.captcha.recaptcha.key lang="app.captcha.language || \'fa\'"> </div> <input hide type="submit"> </form> <div layout=column layout-align="center none" layout-gt-xs=row layout-align-gt-xs="end center" layout-margin> <md-button ng-disabled="(credit.email === undefined && credit.login === undefined) || ctrl.myForm.$invalid" flex-order=0 flex-order-gt-xs=1 class="md-primary md-raised" ng-click=sendToken(credit)>{{\'send recover message\' | translate}}</md-button>     <md-button ng-click=cancel() flex-order=0 flex-order-gt-xs=0 class=md-raised> {{\'cancel\' | translate}} </md-button> </div> </div> </md-content>'),e.put("views/users/mb-login.html",' <md-content layout=row layout-align=none layout-align-gt-sm="center center" flex> <div md-whiteframe=3 style="max-height: none" flex=100 flex-gt-sm=50 layout=column>  <ng-include src="\'views/partials/mb-branding-header-toolbar.html\'"></ng-include> <md-progress-linear ng-disabled="!(ctrl.loginProcess || ctrl.logoutProcess)" style="margin: 0px; padding: 0px" md-mode=indeterminate class=md-primary md-color> </md-progress-linear>  <div style="text-align: center" layout-margin ng-show="!ctrl.loginProcess && ctrl.loginState === \'fail\'"> <p><span md-colors="{color:\'warn\'}" translate>{{loginMessage}}</span></p> </div> <form ng-show=app.user.anonymous name=ctrl.myForm ng-submit=ctrl.login(credit) layout=column layout-margin> <md-input-container> <label translate="">Username</label> <input ng-model=credit.login name=username required> <div ng-messages=ctrl.myForm.username.$error> <div ng-message=required translate="">This field is required.</div> </div> </md-input-container> <md-input-container> <label translate="">Password</label> <input ng-model=credit.password type=password name=password required> <div ng-messages=ctrl.myForm.password.$error> <div ng-message=required translate>This field is required.</div> </div> </md-input-container>  <div ng-if="app.options[\'captcha.engine\']===\'recaptcha\'" vc-recaptcha ng-model=credit.g_recaptcha_response theme="app.captcha.theme || \'light\'" type="app.captcha.type || \'image\'" key="app.options[\'captcha.engine.recaptcha.key\']" lang="app.setting.local || app.config.local || \'en\'"> </div> <input hide type="submit"> <div layout=column layout-align="center none" layout-gt-xs=row layout-align-gt-xs="end center" layout-margin> <a href=users/reset-password style="text-decoration: none" ui-sref=forget flex-order=1 flex-order-gt-xs=-1> <span translate>Forgot your password?</span> </a> <md-button ng-disabled=ctrl.myForm.$invalid flex-order=-1 flex-order-gt-xs=1 class="md-primary md-raised" ng-click="ctrl.login(credit, ctrl.myForm)"> <span translate>Login</span> </md-button></div> </form> <div layout-margin ng-show=!app.user.anonymous layout=column layout-align="none center"> <img width=150px height=150px ng-show=!uploadAvatar ng-src="{{app.user.current.avatar}}"> <h3>{{app.user.current.login}}</h3> <p translate>you are logged in. go to one of the following options.</p> </div> <div ng-show=!app.user.anonymous layout=column layout-align=none layout-gt-xs=row layout-align-gt-xs="center center" layout-margin> <md-button ng-click=ctrl.cancel() flex-order=0 flex-order-gt-xs=0 class=md-raised> <wb-icon>settings_backup_restore</wb-icon> <span translate>Back</span> </md-button> <md-button ng-href=users/account flex-order=1 flex-order-gt-xs=-1 class=md-raised> <wb-icon>account_circle</wb-icon> <span translate>Account</span> </md-button> </div> </div> </md-content>'),e.put("views/users/mb-password.html",'<md-content class=md-padding layout-padding flex>  <mb-titled-block mb-title="Change password" mb-progress=ctrl.changingPassword flex-gt-sm=50> <p translate>Insert current password and new password to change it.</p> <form name=ctrl.passForm ng-submit="ctrl.changePassword(data, ctrl.passForm)" layout=column layout-padding> <input hide type="submit"> <div style="text-align: center" layout-margin ng-show="!ctrl.changingPassword && changePassMessage"> <p><span md-colors="{color:\'warn\'}" translate>{{changePassMessage}}</span></p> </div> <md-input-container layout-fill> <label translate>current password</label> <input name=oldPass ng-model=data.oldPass type=password required> <div ng-messages=ctrl.passForm.oldPass.$error> <div ng-message=required>This is required.</div> </div> </md-input-container> <md-input-container layout-fill> <label translate>new password</label> <input name=newPass ng-model=data.newPass type=password required> <div ng-messages=ctrl.passForm.newPass.$error> <div ng-message=required>This is required.</div> </div> </md-input-container> <md-input-container layout-fill> <label translate>repeat new password</label> <input name=newPass2 ng-model=newPass2 type=password compare-to=data.newPass required> <div ng-messages=ctrl.passForm.newPass2.$error> <div ng-message=required>This is required.</div> <div ng-message=compareTo>password is not match.</div> </div> </md-input-container> <div layout=column layout-align="center none" layout-gt-xs=row layout-align-gt-xs="end center"> <md-button class="md-raised md-primary" ng-click="ctrl.changePassword(data, ctrl.passForm)" ng-disabled=ctrl.passForm.$invalid> <span translate="">Change password</span> </md-button> </div> </form> </mb-titled-block>  </md-content>'),e.put("views/users/mb-profile.html",'<md-content class=md-padding layout-padding flex> <div layout-gt-sm=row layout=column> <mb-titled-block mb-title=Avatar mb-progress=ctrl.avatarLoading flex-gt-sm=50 layout=column layout-margin> <div layout=row layout-align="center start"> <lf-ng-md-file-input ng-if="ctrl.avatarState === \'edit\'" lf-files=ctrl.avatarFiles accept=image/* progress preview drag> </lf-ng-md-file-input> <img ng-if="ctrl.avatarState === \'normal\'" width=60% ng-src=/api/v2/user/accounts/{{ctrl.user.id}}/avatar ng-src-error="https://www.gravatar.com/avatar/{{app.user.current.id|wbmd5}}?d=identicon&size=32"> </div> <div layout=column layout-align="center none" layout-gt-xs=row layout-align-gt-xs="end center" ng-if="ctrl.avatarState === \'normal\'"> <md-button class="md-raised md-primary" ng-click=ctrl.editAvatar()> <sapn translate="">Edit</sapn> </md-button> <md-button class="md-raised md-accent" ng-click=ctrl.deleteAvatar()> <sapn translate="">Delete</sapn> </md-button> </div> <div layout=column layout-align="center none" layout-gt-xs=row layout-align-gt-xs="end center" ng-if="ctrl.avatarState === \'edit\'"> <md-button class="md-raised md-primary" ng-click=ctrl.uploadAvatar(ctrl.avatarFiles)> <sapn translate="">Save</sapn> </md-button> <md-button class="md-raised md-accent" ng-click=ctrl.cancelEditAvatar()> <sapn translate="">Cancele</sapn> </md-button> </div> </mb-titled-block>  <mb-titled-block mb-title="Public Information" mb-progress="ctrl.loadingProfile || ctrl.savingProfile" flex-gt-sm=50 layout=column layout-margin> <form name=contactForm layout=column layout-padding> <md-input-container layout-fill> <label translate="">First Name</label> <input ng-model=ctrl.profile.first_name> </md-input-container> <md-input-container layout-fill> <label translate="">Last Name</label> <input ng-model=ctrl.profile.last_name> </md-input-container> <md-input-container layout-fill> <label translate="">Public Email</label> <input name=email ng-model=ctrl.profile.public_email type=email> </md-input-container> <md-input-container layout-fill> <label translate="">Language</label> <input ng-model=ctrl.profile.language> </md-input-container> <md-input-container layout-fill> <label translate="">Timezone</label> <input ng-model=ctrl.profile.timezone> </md-input-container> </form> <div layout=column layout-align="center none" layout-gt-xs=row layout-align-gt-xs="end center"> <md-button class="md-raised md-primary" ng-click=save()> <sapn translate="">Update</sapn> </md-button> </div> </mb-titled-block> </div> </md-content>'),e.put("views/users/mb-recover-password.html",' <md-content layout=row layout-align=none layout-align-gt-sm="center center" flex> <div md-whiteframe=3 style="max-height: none" flex=100 flex-gt-sm=50 layout=column>  <ng-include src="\'views/partials/mb-branding-header-toolbar.html\'"></ng-include> <md-progress-linear ng-disabled=!ctrl.changingPass style="margin: 0px; padding: 0px" md-mode=indeterminate class=md-primary md-color> </md-progress-linear>  <div layout-margin> <h3 translate>reset password</h3> <p translate>reset password description</p> </div> <div style="text-align: center" layout-margin ng-show=!ctrl.changingPass> <span ng-show="ctrl.changePassState === \'fail\'" md-colors="{color:\'warn\'}" translate>Failed to reset password.</span> <span ng-show="ctrl.changePassState === \'fail\'" md-colors="{color:\'warn\'}" translate>{{$scope.changePassMessage}}</span> <span ng-show="ctrl.changePassState === \'success\'" md-colors="{color:\'primary\'}" translate>Password is reset.</span> </div> <form name=ctrl.myForm ng-submit=changePassword(data) layout=column layout-margin> <md-input-container> <label translate>Token</label> <input ng-model=data.token name=token required> <div ng-messages=ctrl.myForm.token.$error> <div ng-message=required translate>This field is required.</div> </div> </md-input-container> <md-input-container> <label translate>New password</label> <input ng-model=data.password name=password type=password required> <div ng-messages=ctrl.myForm.password.$error> <div ng-message=required translate>This field required.</div> </div> </md-input-container> <md-input-container> <label translate>Repeat new password</label> <input name=password2 ng-model=repeatPassword type=password compare-to=data.password required> <div ng-messages=ctrl.myForm.password2.$error> <div ng-message=required translate>This field is required.</div> <div ng-message=compareTo translate>Passwords is not match.</div> </div> </md-input-container> <input hide type="submit"> </form> <div layout=column layout-align="center none" layout-gt-xs=row layout-align-gt-xs="end center"> <md-button ng-disabled=ctrl.myForm.$invalid flex-order=0 flex-order-gt-xs=1 class="md-primary md-raised" ng-click=changePassword(data)>{{\'change password\' | translate}}</md-button>     <md-button ng-click=cancel() flex-order=0 flex-order-gt-xs=0 class=md-raised> {{\'cancel\' | translate}} </md-button> </div> </div> </md-content>')}]);